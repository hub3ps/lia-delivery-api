{
  "scanned_path": "n8n_workflows/*.json",
  "scanned_at": "2026-01-27",
  "files_found": [
    "n8n_workflows/1. Lia_V3.1.json",
    "n8n_workflows/4. Cancelar_pedido.json",
    "n8n_workflows/5. Atualiza\u00e7\u00e3o_de_pedidos.json",
    "n8n_workflows/6. Recuperar_pedidos.json",
    "n8n_workflows/7. Valida\u00e7\u00e3o_Endere\u00e7os.json",
    "n8n_workflows/Atualiza Card\u00e1pio.json",
    "n8n_workflows/Enviar_pedido.json",
    "n8n_workflows/Gerar Embeddings Card\u00e1pio.json",
    "n8n_workflows/Token_Saipos.json",
    "n8n_workflows/Webhook_Central_Saipos.json"
  ],
  "workflows": [
    {
      "file": "n8n_workflows/1. Lia_V3.1.json",
      "workflow_name": "1. Lia_V3.1",
      "workflow_id": "hKJrh1rR0neyjRvs",
      "nodes": [
        {
          "id": "f3a917f8-b7d2-4769-aeb1-f4d9b303fedd",
          "name": "Mensagem chegando?",
          "type": "n8n-nodes-base.filter"
        },
        {
          "id": "dc69fb75-17b4-4574-9d60-daded7b65374",
          "name": "Mensagem recebida",
          "type": "n8n-nodes-base.webhook"
        },
        {
          "id": "8fa19d54-ae6f-40d4-bcc2-549a1d157b65",
          "name": "Mensagem encavalada?",
          "type": "n8n-nodes-base.code"
        },
        {
          "id": "f5bb5b9c-0109-4906-9367-48df87c660d9",
          "name": "Buscar mensagens",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "c8d9ec83-6542-43ce-ad23-fa3e429428b5",
          "name": "Concatenar mensagens",
          "type": "n8n-nodes-base.set"
        },
        {
          "id": "a51493d4-efb0-4ba2-ae4c-606163a40c2f",
          "name": "Limpar fila de mensagens",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "4ccb67d7-5c10-482f-aa29-324532f71fc5",
          "name": "Sticky Note2",
          "type": "n8n-nodes-base.stickyNote"
        },
        {
          "id": "67043511-8db6-475a-bd66-f55d73ce0d7b",
          "name": "Esperar",
          "type": "n8n-nodes-base.wait"
        },
        {
          "id": "e8126e5e-cbd4-446a-b520-4ae19782ed4b",
          "name": "Sticky Note3",
          "type": "n8n-nodes-base.stickyNote"
        },
        {
          "id": "e158c0f9-6e8b-4903-9813-a5c2adcdc5ca",
          "name": "Sticky Note4",
          "type": "n8n-nodes-base.stickyNote"
        },
        {
          "id": "daab215a-0aaf-44b5-bd92-5dadd39ff37e",
          "name": "Sticky Note5",
          "type": "n8n-nodes-base.stickyNote"
        },
        {
          "id": "d291e5e3-902c-4631-86be-9f9a1b93dfff",
          "name": "Tipo de mensagem",
          "type": "n8n-nodes-base.switch"
        },
        {
          "id": "2b8ba7b0-f6d5-43b3-8b20-d880edfee428",
          "name": "Transcrever \u00e1udio",
          "type": "@n8n/n8n-nodes-langchain.openAi"
        },
        {
          "id": "f02d2e6e-159b-4b2e-a2d4-0082d9613d98",
          "name": "Sticky Note6",
          "type": "n8n-nodes-base.stickyNote"
        },
        {
          "id": "72e5ffd6-df7e-4136-bbb9-dab0bde9c246",
          "name": "Resetar status",
          "type": "n8n-nodes-evolution-api.evolutionApi"
        },
        {
          "id": "8bc6d117-b93d-4e76-8129-04f5c2e172dc",
          "name": "Converter \u00e1udio para base64",
          "type": "n8n-nodes-base.extractFromFile"
        },
        {
          "id": "21dfa125-530b-4a6d-81d0-6e7825c23c36",
          "name": "Sticky Note12",
          "type": "n8n-nodes-base.stickyNote"
        },
        {
          "id": "700ef2a7-4535-4798-b20e-adc8b7b77f06",
          "name": "Gerar \u00e1udio",
          "type": "n8n-nodes-base.httpRequest"
        },
        {
          "id": "a525e6fe-8331-41bc-996e-cd7eedf20128",
          "name": "Formatar SSML",
          "type": "@n8n/n8n-nodes-langchain.chainLlm"
        },
        {
          "id": "d3cd199a-38d9-4308-889a-4358f97c249f",
          "name": "Tipo de mensagem1",
          "type": "n8n-nodes-base.switch"
        },
        {
          "id": "f2b4fa71-067e-41df-9241-0585f654e9bf",
          "name": "Memory",
          "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat"
        },
        {
          "id": "3ba92b3e-5219-4c81-9b45-00b594602203",
          "name": "Responder mensagem \u00e1udio",
          "type": "n8n-nodes-evolution-api.evolutionApi"
        },
        {
          "id": "14e3ef56-d059-4507-926f-ae5869fb93ec",
          "name": "Converter base64 para \u00e1udio.",
          "type": "n8n-nodes-base.convertToFile"
        },
        {
          "id": "30db27c0-35c3-4e26-882a-14fc0a5f4828",
          "name": "Enfileirar mensagem.",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "4832ba2c-efff-4989-93ad-d4616015efeb",
          "name": "Google Gemini Chat Model.",
          "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini"
        },
        {
          "id": "f7eb1080-324f-4508-9dc7-0757b857514e",
          "name": "Info",
          "type": "n8n-nodes-base.set"
        },
        {
          "id": "7614af66-47bd-49d6-b03b-a4ae5201a259",
          "name": "cancelar_pedido",
          "type": "n8n-nodes-base.httpRequestTool"
        },
        {
          "id": "4e62e363-6d65-4f98-a59b-b602b5c5725e",
          "name": "Code",
          "type": "n8n-nodes-base.code"
        },
        {
          "id": "7680728b-a97a-40b1-bd92-37ec4c106c98",
          "name": "Loop Over Items",
          "type": "n8n-nodes-base.splitInBatches"
        },
        {
          "id": "9d3d1c90-f2ee-4380-8b8b-6badc0bb4470",
          "name": "HTTP Request",
          "type": "n8n-nodes-base.httpRequest"
        },
        {
          "id": "1df8c600-732e-40d9-ac4b-2ab1a7321c81",
          "name": "HTTP Request1",
          "type": "n8n-nodes-base.httpRequest"
        },
        {
          "id": "31cdc6e0-4b2c-4700-b7e2-aee3deb384d3",
          "name": "HTTP Request2",
          "type": "n8n-nodes-base.httpRequest"
        },
        {
          "id": "3b9ce552-7cf4-4650-ba27-e61e97e5e6cd",
          "name": "Marcar como lida texto",
          "type": "n8n-nodes-evolution-api.evolutionApi"
        },
        {
          "id": "b3638eae-e47e-4dfe-94d0-3c8b577cb64d",
          "name": "controle atendimentos",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "9e09756c-5e31-4387-8665-39bdd0d913c2",
          "name": "atualiza atendimento",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "4e3dec4b-34cd-4576-81c7-56c8e907d3fc",
          "name": "Marcar como lida audio",
          "type": "n8n-nodes-evolution-api.evolutionApi"
        },
        {
          "id": "85fbcfb1-8427-4482-a34f-d56164231287",
          "name": "controle atendimentos1",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "25ca5262-c729-4127-8b8e-ac57ea758b6d",
          "name": "Convert to File",
          "type": "n8n-nodes-base.convertToFile"
        },
        {
          "id": "a00b60df-b19a-4b1c-a588-466059385342",
          "name": "OpenAI",
          "type": "@n8n/n8n-nodes-langchain.openAi"
        },
        {
          "id": "ae694ad5-fddc-4287-ac52-0a82006f75a9",
          "name": "Sticky Note",
          "type": "n8n-nodes-base.stickyNote"
        },
        {
          "id": "4f01ea44-7ddd-421f-8801-458dc94b83bd",
          "name": "Marcar como lida audio1",
          "type": "n8n-nodes-evolution-api.evolutionApi"
        },
        {
          "id": "ba5e58a4-adae-4005-9b03-586f59cd601c",
          "name": "controle atendimentos2",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "ddeb99a3-9f98-46a5-a2e7-98296d1f2916",
          "name": "Atendente",
          "type": "@n8n/n8n-nodes-langchain.agent"
        },
        {
          "id": "bff1176e-4b56-4ed1-9898-4df7de5d56a0",
          "name": "taxa_entrega",
          "type": "n8n-nodes-base.postgresTool"
        },
        {
          "id": "bc46ec9c-3751-45e4-81d6-7702aed9fb81",
          "name": "Chat Memory Manager",
          "type": "@n8n/n8n-nodes-langchain.memoryManager"
        },
        {
          "id": "2aef5b99-c5a8-483f-854f-dbcbb26d6529",
          "name": "Postgres Chat Memory",
          "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat"
        },
        {
          "id": "3c552c81-3f61-41cf-bf9a-101ca6101290",
          "name": "When clicking \u2018Execute workflow\u2019",
          "type": "n8n-nodes-base.manualTrigger"
        },
        {
          "id": "c6883af4-5819-4d6f-9dd8-527667aa4b83",
          "name": "OpenAI2",
          "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi"
        },
        {
          "id": "4fb97b33-5ff7-4220-a77a-29f562f767be",
          "name": "Convert to File2",
          "type": "n8n-nodes-base.convertToFile"
        },
        {
          "id": "ef10f770-3ae2-4bde-83f5-9fafd28cd05e",
          "name": "enviar_pedido",
          "type": "n8n-nodes-base.httpRequestTool"
        },
        {
          "id": "21514567-6f4f-41f0-bcf1-e3e568587a4f",
          "name": "Convert to File1",
          "type": "n8n-nodes-base.convertToFile"
        },
        {
          "id": "ed8fbb5c-1cf1-4717-8832-42bfd2398c02",
          "name": "Analyze document",
          "type": "@n8n/n8n-nodes-langchain.googleGemini"
        },
        {
          "id": "0258b464-472f-4234-90aa-468d16a62a3a",
          "name": "Sticky Note1",
          "type": "n8n-nodes-base.stickyNote"
        },
        {
          "id": "e20150ff-8eae-4e95-a00a-4dafe9964701",
          "name": "Marcar como lida audio2",
          "type": "n8n-nodes-evolution-api.evolutionApi"
        },
        {
          "id": "d0d2155e-1872-497f-83a6-35d4a28d0800",
          "name": "controle atendimentos3",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "320dcae4-754d-4b0b-b160-b464759054ac",
          "name": "calcular_totais",
          "type": "@n8n/n8n-nodes-langchain.toolCode"
        },
        {
          "id": "bc148a11-c7ec-4d68-933d-7248c4e93e3b",
          "name": "Execution Data",
          "type": "n8n-nodes-base.executionData"
        },
        {
          "id": "73651afc-3948-484e-b463-34573ef27296",
          "name": "stages",
          "type": "n8n-nodes-base.postgresTool"
        },
        {
          "id": "2459e30e-3c76-4a5b-bd0d-b71997a91b08",
          "name": "cardapio",
          "type": "n8n-nodes-base.postgresTool"
        },
        {
          "id": "e990fbf6-c983-4a5d-baaa-a0de3fad5105",
          "name": "maps",
          "type": "@n8n/n8n-nodes-langchain.toolWorkflow"
        },
        {
          "id": "bfd2d491-bf3f-4f27-8be9-2146d577d0d1",
          "name": "Sticky Note13",
          "type": "n8n-nodes-base.stickyNote"
        },
        {
          "id": "695d18fd-e05f-486c-bd18-e4a2b72ee1e3",
          "name": "liberado",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "4ef66efc-6856-4ffe-9369-e51fc2c726b2",
          "name": "humano assumiu",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "a3dfd2e7-d160-433b-b4a2-568e8243a834",
          "name": "Filtro de Remetente",
          "type": "n8n-nodes-base.if"
        },
        {
          "id": "a37af949-52e3-4e52-9a13-93781355bdf5",
          "name": "historico1",
          "type": "n8n-nodes-base.postgres"
        }
      ],
      "connections": [
        {
          "source": "Mensagem chegando?",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Tipo de mensagem",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Mensagem recebida",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Info",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Mensagem encavalada?",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Limpar fila de mensagens",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Buscar mensagens",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Mensagem encavalada?",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Concatenar mensagens",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Atendente",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Limpar fila de mensagens",
          "source_output": "main",
          "source_output_index": 0,
          "target": "controle atendimentos",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Esperar",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Buscar mensagens",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Tipo de mensagem",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Enfileirar mensagem.",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Tipo de mensagem",
          "source_output": "main",
          "source_output_index": 1,
          "target": "HTTP Request1",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Tipo de mensagem",
          "source_output": "main",
          "source_output_index": 2,
          "target": "Convert to File",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Tipo de mensagem",
          "source_output": "main",
          "source_output_index": 3,
          "target": "Convert to File2",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Tipo de mensagem",
          "source_output": "main",
          "source_output_index": 5,
          "target": "Convert to File1",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Transcrever \u00e1udio",
          "source_output": "main",
          "source_output_index": 0,
          "target": "controle atendimentos1",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Resetar status",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Responder mensagem \u00e1udio",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Converter \u00e1udio para base64",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Resetar status",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Gerar \u00e1udio",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Converter \u00e1udio para base64",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Formatar SSML",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Gerar \u00e1udio",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Tipo de mensagem1",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Code",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Tipo de mensagem1",
          "source_output": "main",
          "source_output_index": 1,
          "target": "Formatar SSML",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Memory",
          "source_output": "ai_memory",
          "source_output_index": 0,
          "target": "Atendente",
          "target_input": "ai_memory",
          "target_input_index": 0
        },
        {
          "source": "Converter base64 para \u00e1udio.",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Transcrever \u00e1udio",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Enfileirar mensagem.",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Esperar",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Google Gemini Chat Model.",
          "source_output": "ai_languageModel",
          "source_output_index": 0,
          "target": "Formatar SSML",
          "target_input": "ai_languageModel",
          "target_input_index": 0
        },
        {
          "source": "Info",
          "source_output": "main",
          "source_output_index": 0,
          "target": "historico1",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "cancelar_pedido",
          "source_output": "ai_tool",
          "source_output_index": 0,
          "target": "Atendente",
          "target_input": "ai_tool",
          "target_input_index": 0
        },
        {
          "source": "Code",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Loop Over Items",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Loop Over Items",
          "source_output": "main",
          "source_output_index": 1,
          "target": "HTTP Request",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "HTTP Request",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Loop Over Items",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "HTTP Request",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Execution Data",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "HTTP Request1",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Converter base64 para \u00e1udio.",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "HTTP Request1",
          "source_output": "main",
          "source_output_index": 1,
          "target": "HTTP Request2",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "HTTP Request2",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Converter base64 para \u00e1udio.",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Marcar como lida texto",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Concatenar mensagens",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "controle atendimentos",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Marcar como lida texto",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "atualiza atendimento",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Tipo de mensagem1",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Marcar como lida audio",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Concatenar mensagens",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "controle atendimentos1",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Marcar como lida audio",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Convert to File",
          "source_output": "main",
          "source_output_index": 0,
          "target": "OpenAI",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Marcar como lida audio1",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Concatenar mensagens",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "controle atendimentos2",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Marcar como lida audio1",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "OpenAI",
          "source_output": "main",
          "source_output_index": 0,
          "target": "controle atendimentos2",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Atendente",
          "source_output": "main",
          "source_output_index": 0,
          "target": "atualiza atendimento",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "taxa_entrega",
          "source_output": "ai_tool",
          "source_output_index": 0,
          "target": "Atendente",
          "target_input": "ai_tool",
          "target_input_index": 0
        },
        {
          "source": "Postgres Chat Memory",
          "source_output": "ai_memory",
          "source_output_index": 0,
          "target": "Chat Memory Manager",
          "target_input": "ai_memory",
          "target_input_index": 0
        },
        {
          "source": "When clicking \u2018Execute workflow\u2019",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Chat Memory Manager",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "OpenAI2",
          "source_output": "ai_languageModel",
          "source_output_index": 0,
          "target": "Atendente",
          "target_input": "ai_languageModel",
          "target_input_index": 0
        },
        {
          "source": "Convert to File2",
          "source_output": "main",
          "source_output_index": 0,
          "target": "OpenAI",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "enviar_pedido",
          "source_output": "ai_tool",
          "source_output_index": 0,
          "target": "Atendente",
          "target_input": "ai_tool",
          "target_input_index": 0
        },
        {
          "source": "Convert to File1",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Analyze document",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Marcar como lida audio2",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Concatenar mensagens",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "controle atendimentos3",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Marcar como lida audio2",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Analyze document",
          "source_output": "main",
          "source_output_index": 0,
          "target": "controle atendimentos3",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "calcular_totais",
          "source_output": "ai_tool",
          "source_output_index": 0,
          "target": "Atendente",
          "target_input": "ai_tool",
          "target_input_index": 0
        },
        {
          "source": "stages",
          "source_output": "ai_tool",
          "source_output_index": 0,
          "target": "Atendente",
          "target_input": "ai_tool",
          "target_input_index": 0
        },
        {
          "source": "cardapio",
          "source_output": "ai_tool",
          "source_output_index": 0,
          "target": "Atendente",
          "target_input": "ai_tool",
          "target_input_index": 0
        },
        {
          "source": "maps",
          "source_output": "ai_tool",
          "source_output_index": 0,
          "target": "Atendente",
          "target_input": "ai_tool",
          "target_input_index": 0
        },
        {
          "source": "liberado",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Mensagem chegando?",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Filtro de Remetente",
          "source_output": "main",
          "source_output_index": 0,
          "target": "humano assumiu",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Filtro de Remetente",
          "source_output": "main",
          "source_output_index": 1,
          "target": "liberado",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "historico1",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Filtro de Remetente",
          "target_input": "main",
          "target_input_index": 0
        }
      ],
      "triggers": [
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "dc69fb75-17b4-4574-9d60-daded7b65374",
          "node_name": "Mensagem recebida",
          "type": "n8n-nodes-base.webhook",
          "http_method": "POST",
          "path": "v3.1"
        }
      ],
      "http_requests": [
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "700ef2a7-4535-4798-b20e-adc8b7b77f06",
          "node_name": "Gerar \u00e1udio",
          "method": "POST",
          "url": "https://api.elevenlabs.io/v1/text-to-speech/33B4UnXyTNbgLmdEDh5P",
          "headers": null,
          "body": {
            "parameters": [
              {
                "name": "text",
                "value": "={{ $json.text }}"
              },
              {
                "name": "model_id",
                "value": "eleven_flash_v2_5"
              }
            ]
          }
        },
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "7614af66-47bd-49d6-b03b-a4ae5201a259",
          "node_name": "cancelar_pedido",
          "method": "POST",
          "url": "https://webhook.hub3ps.com/webhook/cancelar_pedido",
          "headers": null,
          "body": {
            "parameters": [
              {
                "name": "telefone",
                "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters0_Value', ``, 'string') }}"
              },
              {
                "name": "order_id",
                "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters1_Value', ``, 'string') }}"
              }
            ]
          }
        },
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "9d3d1c90-f2ee-4380-8b8b-6badc0bb4470",
          "node_name": "HTTP Request",
          "method": "POST",
          "url": "={{ $('Info').item.json.url_evolution }}message/sendText/{{ $('Info').item.json.instancia }}",
          "headers": {
            "apikey": "BE079E70E632-4EE7-8073-A32C924D5057"
          },
          "body": "={\n  \"number\": \"{{ $('Info').item.json.telefone }}\",\n  \"text\": \"{{JSON.stringify($json.mensagem).slice(1,-1)}}\",\n  \"delay\": 4000\n}"
        },
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "1df8c600-732e-40d9-ac4b-2ab1a7321c81",
          "node_name": "HTTP Request1",
          "method": "POST",
          "url": "={{ $json.url_evolution }}/chat/getBase64FromMediaMessage/{{ $json.instancia }}",
          "headers": {
            "apikey": "BE079E70E632-4EE7-8073-A32C924D5057"
          },
          "body": "={\n  \"message\": {\n    \"key\": {\n      \"id\": \"{{ $json.id_mensagem }}\"\n    }\n  },\n  \"convertToMp4\": true\n}"
        },
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "31cdc6e0-4b2c-4700-b7e2-aee3deb384d3",
          "node_name": "HTTP Request2",
          "method": "POST",
          "url": "={{ $json.url_evolution }}/chat/getBase64FromMediaMessage/{{ $json.instancia }}",
          "headers": {
            "apikey": "BE079E70E632-4EE7-8073-A32C924D5057"
          },
          "body": "={\n  \"message\": {\n    \"key\": {\n      \"id\": \"{{ $json.url_audio }}\"\n    }\n  },\n  \"convertToMp4\": true\n}"
        },
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "ef10f770-3ae2-4bde-83f5-9fafd28cd05e",
          "node_name": "enviar_pedido",
          "method": "POST",
          "url": "https://webhook.hub3ps.com/webhook/enviar-pedido",
          "headers": null,
          "body": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('JSON', ``, 'json') }}"
        }
      ],
      "postgres_queries": [
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "f5bb5b9c-0109-4906-9367-48df87c660d9",
          "node_name": "Buscar mensagens",
          "operation": "select",
          "schema": "public",
          "table": "n8n_fila_mensagens",
          "query": null,
          "where": {
            "values": [
              {
                "column": "telefone",
                "value": "={{ $json.telefone }}"
              },
              {
                "column": "status",
                "value": "={{ $json.status }}"
              }
            ]
          }
        },
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "a51493d4-efb0-4ba2-ae4c-606163a40c2f",
          "node_name": "Limpar fila de mensagens",
          "operation": "deleteTable",
          "schema": "public",
          "table": "n8n_fila_mensagens",
          "query": null,
          "where": {
            "values": [
              {
                "column": "telefone",
                "value": "={{$json.telefone}}"
              }
            ]
          }
        },
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "f2b4fa71-067e-41df-9241-0585f654e9bf",
          "node_name": "Memory",
          "operation": null,
          "schema": null,
          "table": null,
          "query": null
        },
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "30db27c0-35c3-4e26-882a-14fc0a5f4828",
          "node_name": "Enfileirar mensagem.",
          "operation": null,
          "schema": "public",
          "table": "n8n_fila_mensagens",
          "query": null,
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "telefone": "={{ $('Info').item.json.telefone }}",
              "mensagem": "={{ $('Info').item.json.mensagem }}",
              "timestamp": "={{ $('Info').item.json.timestamp.toDateTime('s') }}",
              "id_mensagem": "={{ $('Info').item.json.id_mensagem }}",
              "client_id": "={{ \"06a81600-26fc-472b-880e-e6293943354e\" }}",
              "trace_id": "={{ $json.trace_id }}",
              "message_id": "={{ $json.id_mensagem }}",
              "remote_jid": "={{ $json.remote_jid }}",
              "message_type": "={{ $json.message_type }}",
              "status": "={{ \"pending\" }}"
            },
            "matchingColumns": [
              "id"
            ],
            "schema": [
              {
                "id": "id",
                "displayName": "id",
                "required": false,
                "defaultMatch": true,
                "display": true,
                "type": "number",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "id_mensagem",
                "displayName": "id_mensagem",
                "required": true,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "telefone",
                "displayName": "telefone",
                "required": true,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "mensagem",
                "displayName": "mensagem",
                "required": true,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "timestamp",
                "displayName": "timestamp",
                "required": true,
                "defaultMatch": false,
                "display": true,
                "type": "dateTime",
                "canBeUsedToMatch": true
              },
              {
                "id": "client_id",
                "displayName": "client_id",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "trace_id",
                "displayName": "trace_id",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "message_id",
                "displayName": "message_id",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "remote_jid",
                "displayName": "remote_jid",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "message_type",
                "displayName": "message_type",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "status",
                "displayName": "status",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "locked_at",
                "displayName": "locked_at",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "dateTime",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "locked_by",
                "displayName": "locked_by",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "processed_at",
                "displayName": "processed_at",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "dateTime",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "error",
                "displayName": "error",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "b3638eae-e47e-4dfe-94d0-3c8b577cb64d",
          "node_name": "controle atendimentos",
          "operation": "executeQuery",
          "schema": null,
          "table": null,
          "query": "INSERT INTO public.active_sessions AS s\n  (session_id, last_message, last_message_type, status)\nVALUES\n  (\n    '{{ $(\"Info\").first().json.telefone || $json.session_id }}',   -- fone (sem +)\n    '{{ $(\"Mensagem encavalada?\").all().map(i => i.json.mensagem).join(\"\\\\n\") }}',  -- texto puro\n    'human',\n    'active'\n  )\nON CONFLICT (session_id) WHERE (status = 'active')\nDO UPDATE\n   SET last_message      = EXCLUDED.last_message,\n       last_message_type = 'human',\n       updated_at        = now(),\n       followup_sent_at  = NULL;  -- reseta quando o humano responde"
        },
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "9e09756c-5e31-4387-8665-39bdd0d913c2",
          "node_name": "atualiza atendimento",
          "operation": "executeQuery",
          "schema": null,
          "table": null,
          "query": "INSERT INTO public.active_sessions\n  (session_id, last_message, last_message_type, status)\nVALUES\n  (\n    '{{ $(\"Info\").first().json.telefone || $json.session_id }}',\n    '{{ String($json.output || $json.text || $json.reply || \"\").replace(/'/g,\"''\") }}',\n    'ai',\n    'active'\n  )\nON CONFLICT (session_id) WHERE (status = 'active')\nDO UPDATE\n   SET last_message      = EXCLUDED.last_message,\n       last_message_type = 'ai',\n       updated_at        = now();\n"
        },
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "85fbcfb1-8427-4482-a34f-d56164231287",
          "node_name": "controle atendimentos1",
          "operation": "executeQuery",
          "schema": null,
          "table": null,
          "query": "INSERT INTO public.active_sessions AS s\n  (session_id, last_message, last_message_type, status)\nVALUES\n  (\n    '{{ $('Info').item.json.telefone || $json.session_id }}',   -- fone (sem +)\n    '{{ $json.text }}',                       -- texto puro\n    'human',\n    'active'\n  )\nON CONFLICT (session_id) WHERE (status = 'active')\nDO UPDATE\n   SET last_message      = EXCLUDED.last_message,\n       last_message_type = 'human',\n       updated_at        = now(),\n       followup_sent_at  = NULL;  -- reseta quando o humano responde"
        },
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "ba5e58a4-adae-4005-9b03-586f59cd601c",
          "node_name": "controle atendimentos2",
          "operation": "executeQuery",
          "schema": null,
          "table": null,
          "query": "INSERT INTO public.active_sessions AS s\n  (session_id, last_message, last_message_type, status)\nVALUES\n  (\n    '{{ $('Info').item.json.telefone || $json.session_id }}',   -- fone (sem +)\n    '{{ $json.content }}',                       -- texto puro\n    'human',\n    'active'\n  )\nON CONFLICT (session_id) WHERE (status = 'active')\nDO UPDATE\n   SET last_message      = EXCLUDED.last_message,\n       last_message_type = 'human',\n       updated_at        = now(),\n       followup_sent_at  = NULL;  -- reseta quando o humano responde"
        },
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "bff1176e-4b56-4ed1-9898-4df7de5d56a0",
          "node_name": "taxa_entrega",
          "operation": "executeQuery",
          "schema": null,
          "table": null,
          "query": "SELECT \n  district AS bairro,\n  delivery_fee AS taxa_entrega,\n  city AS cidade\nFROM delivery_areas\nWHERE active = true\n  AND unaccent(LOWER(city)) = unaccent(LOWER('Itaja\u00ed'))\n  AND (\n    unaccent(LOWER(district)) = unaccent(LOWER($1))\n    OR unaccent(LOWER(district)) LIKE '%' || unaccent(LOWER($1)) || '%'\n  )\nORDER BY \n  CASE \n    WHEN unaccent(LOWER(district)) = unaccent(LOWER($1)) THEN 0 \n    ELSE 1 \n  END,\n  district\nLIMIT 10;"
        },
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "2aef5b99-c5a8-483f-854f-dbcbb26d6529",
          "node_name": "Postgres Chat Memory",
          "operation": null,
          "schema": null,
          "table": null,
          "query": null
        },
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "d0d2155e-1872-497f-83a6-35d4a28d0800",
          "node_name": "controle atendimentos3",
          "operation": "executeQuery",
          "schema": null,
          "table": null,
          "query": "INSERT INTO public.active_sessions AS s\n  (session_id, last_message, last_message_type, status)\nVALUES\n  (\n    '{{ $('Info').item.json.telefone || $json.session_id }}',   -- fone (sem +)\n    '{{ $json.content }}',                       -- texto puro\n    'human',\n    'active'\n  )\nON CONFLICT (session_id) WHERE (status = 'active')\nDO UPDATE\n   SET last_message      = EXCLUDED.last_message,\n       last_message_type = 'human',\n       updated_at        = now(),\n       followup_sent_at  = NULL;  -- reseta quando o humano responde"
        },
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "73651afc-3948-484e-b463-34573ef27296",
          "node_name": "stages",
          "operation": "executeQuery",
          "schema": null,
          "table": null,
          "query": "SELECT\n  stage,\n  rules\nFROM public.delivery_policies_v2\nWHERE\n  client_id = '06a81600-26fc-472b-880e-e6293943354e'::uuid\n  AND stage = $1\n  AND is_active = true\nLIMIT 1;"
        },
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "2459e30e-3c76-4a5b-bd0d-b71997a91b08",
          "node_name": "cardapio",
          "operation": "executeQuery",
          "schema": null,
          "table": null,
          "query": "SELECT\n  categoria,\n  item,\n  tamanho,\n  tipo,\n  price,\n  adicionais\nFROM public.menu_catalog_agent_v1\nWHERE client_id = '06a81600-26fc-472b-880e-e6293943354e'::uuid;"
        },
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "695d18fd-e05f-486c-bd18-e4a2b72ee1e3",
          "node_name": "liberado",
          "operation": "executeQuery",
          "schema": null,
          "table": null,
          "query": "SELECT 1\nWHERE NOT EXISTS (\n  SELECT 1\n  FROM public.active_sessions\n  WHERE session_id = '{{ $json.telefone }}'\n    AND last_message_type <> 'ai'\n);"
        },
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "4ef66efc-6856-4ffe-9369-e51fc2c726b2",
          "node_name": "humano assumiu",
          "operation": "executeQuery",
          "schema": null,
          "table": null,
          "query": "INSERT INTO public.active_sessions\n  (session_id, last_message, last_message_type, status)\nVALUES\n  (\n    '{{ $(\"Info\").first().json.telefone || $json.session_id }}',\n    '{{ String($json.output || $json.text || $json.reply || \"\").replace(/'/g,\"''\") }}',\n    'human',\n    'active'\n  )\nON CONFLICT (session_id) WHERE (status = 'active')\nDO UPDATE\n   SET last_message      = EXCLUDED.last_message,\n       last_message_type = 'human',\n       updated_at        = now();\n"
        },
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "a37af949-52e3-4e52-9a13-93781355bdf5",
          "node_name": "historico1",
          "operation": "executeQuery",
          "schema": null,
          "table": null,
          "query": "WITH inp AS (\n  SELECT regexp_replace($1::text, '\\D', '', 'g') AS d\n),\ncand AS (\n  -- d (como veio), d sem 55 e d com 55\n  SELECT d                            AS k FROM inp\n  UNION ALL SELECT CASE WHEN left(d,2)='55' THEN substring(d from 3) ELSE d END FROM inp\n  UNION ALL SELECT CASE WHEN left(d,2)='55' THEN d ELSE '55'||d END FROM inp\n)\nSELECT *\nFROM public.view_client_snapshot\nWHERE regexp_replace(phone, '\\D', '', 'g') IN (SELECT k FROM cand)\nORDER BY last_order_at DESC NULLS LAST\nLIMIT 1;"
        }
      ],
      "code_nodes": [
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "8fa19d54-ae6f-40d4-bcc2-549a1d157b65",
          "node_name": "Mensagem encavalada?",
          "language": "javascript",
          "snippet": "const ultima_mensagem_da_fila = $input.last()\nconst mensagem_do_workflow = $('Info').first()\n\nif (ultima_mensagem_da_fila.json.id_mensagem !== mensagem_do_workflow.json.id_mensagem) {\n  // Mensagem encavalada, para o workflow\n  return [];\n}\n\n// Pass-through da fila de mensagens\nreturn $input.all();"
        },
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "4e62e363-6d65-4f98-a59b-b602b5c5725e",
          "node_name": "Code",
          "language": "javascript",
          "snippet": "// Prioriza o texto do node \"Atendente\"\nconst fromAttNode =\n  ($node[\"Atendente\"]?.json?.output) ??\n  ($items(\"Atendente\")?.[0]?.json?.output);\n\n// Demais fontes (fallbacks)\nconst raw =\n  fromAttNode ??\n  $json?.message?.content ??\n  $json?.output ??\n  $json?.mensagem ??\n  $json?.text ??\n  $json?.te\u2026"
        },
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "320dcae4-754d-4b0b-b160-b464759054ac",
          "node_name": "calcular_totais",
          "language": "javascript",
          "snippet": "// Tool \"calcular_totais\" para o AI Agent do n8n\n\nlet data = query ?? {};\n\n// --- LIMPEZA E PARSE DO INPUT ---\nif (typeof data === 'string') {\n  try {\n    // 1. Remove formata\u00e7\u00e3o de c\u00f3digo markdown (```json e ```)\n    let cleanData = data.replace(/```json/gi, '').replace(/```/g, '').trim();\n\n    // \u2026"
        }
      ],
      "whatsapp_messages": [
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "30db27c0-35c3-4e26-882a-14fc0a5f4828",
          "node_name": "Enfileirar mensagem.",
          "key": "mensagem",
          "text": "={{ $('Info').item.json.mensagem }}"
        },
        {
          "workflow": "1. Lia_V3.1",
          "node_id": "9d3d1c90-f2ee-4380-8b8b-6badc0bb4470",
          "node_name": "HTTP Request",
          "key": "jsonBody.text",
          "text": "{{JSON.stringify($json.mensagem).slice(1,-1)}}"
        }
      ]
    },
    {
      "file": "n8n_workflows/4. Cancelar_pedido.json",
      "workflow_name": "4. Cancelar_pedido",
      "workflow_id": "Fgl2rEbM3dYTtTES",
      "nodes": [
        {
          "id": "b33d1e3c-934b-4bd9-9b7a-632312017a13",
          "name": "Webhook",
          "type": "n8n-nodes-base.webhook"
        },
        {
          "id": "b0e779e2-f9bb-4136-ba17-74b5b8309f8d",
          "name": "Postgres",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "43cf27e3-6f9f-4abc-aecd-d46b0290a7c1",
          "name": "HTTP Request",
          "type": "n8n-nodes-base.httpRequest"
        }
      ],
      "connections": [
        {
          "source": "Webhook",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Postgres",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Postgres",
          "source_output": "main",
          "source_output_index": 0,
          "target": "HTTP Request",
          "target_input": "main",
          "target_input_index": 0
        }
      ],
      "triggers": [
        {
          "workflow": "4. Cancelar_pedido",
          "node_id": "b33d1e3c-934b-4bd9-9b7a-632312017a13",
          "node_name": "Webhook",
          "type": "n8n-nodes-base.webhook",
          "http_method": "POST",
          "path": "cancelar_pedido"
        }
      ],
      "http_requests": [
        {
          "workflow": "4. Cancelar_pedido",
          "node_id": "43cf27e3-6f9f-4abc-aecd-d46b0290a7c1",
          "node_name": "HTTP Request",
          "method": "POST",
          "url": "https://order-api.saipos.com/cancel-order",
          "headers": {
            "Authorization": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZFBhcnRuZXIiOiIxYmM0Yzg2NWRlMTk1NDIxMjkxNWJiMGQzMjgzMzI4ZCIsImNyZWF0ZWQiOjE3NTU1NDM0NjE1MTMsImlhdCI6MTc1NTU0MzQ2MSwiZXhwIjoxNzU1NzE2MjYxfQ.tm0t4krNWv-xwsNK-6hnOZWO1PCLUtVp3cmrqwqaf5U",
            "accept": "application/json",
            "content-type": "application/json"
          },
          "body": {
            "parameters": [
              {
                "name": "cod_store",
                "value": "123"
              },
              {
                "name": "order_id",
                "value": "=1755635138128"
              }
            ]
          }
        }
      ],
      "postgres_queries": [
        {
          "workflow": "4. Cancelar_pedido",
          "node_id": "b0e779e2-f9bb-4136-ba17-74b5b8309f8d",
          "node_name": "Postgres",
          "operation": "select",
          "schema": "public",
          "table": "orders",
          "query": null,
          "where": {
            "values": [
              {
                "column": "order_id",
                "value": "={{ $json.body.order_id }}"
              }
            ]
          }
        }
      ],
      "code_nodes": [],
      "whatsapp_messages": []
    },
    {
      "file": "n8n_workflows/5. Atualiza\u00e7\u00e3o_de_pedidos.json",
      "workflow_name": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "workflow_id": "5kPX7EEDgsat28no",
      "nodes": [
        {
          "id": "9e119b9d-ca97-480e-a2cb-bd69c9dd29c4",
          "name": "Webhook",
          "type": "n8n-nodes-base.webhook"
        },
        {
          "id": "47cc30d8-7a80-4483-96b7-b4602083d136",
          "name": "Verificar Status",
          "type": "n8n-nodes-base.switch"
        },
        {
          "id": "3c1098ac-9082-4473-92df-2c0589218a69",
          "name": "Confirmado",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "7d1d26e5-a15f-439a-889d-8ed44a17576a",
          "name": "Aguardando entrega",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "13c43016-22ef-44ec-a482-2d92ac73b2d6",
          "name": "Saiu para entrega",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "bb603380-026f-4aac-ba8c-6d4a11ed78ef",
          "name": "Entregue",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "803ca9bd-1404-499e-b7d9-091c35b19f4f",
          "name": "Cancelado",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "b1bb18d3-e418-47ad-81ec-b02d8ad55407",
          "name": "Postgres",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "8e021fef-74ae-49c1-9213-27e37ddabd33",
          "name": "Postgres1",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "3c800162-67f1-4f9f-b655-a8f73fe576c8",
          "name": "Enviar mensagem",
          "type": "n8n-nodes-base.httpRequest"
        },
        {
          "id": "05c3181a-2456-4315-a975-f45f7e4418fb",
          "name": "Enviar mensagem1",
          "type": "n8n-nodes-base.httpRequest"
        },
        {
          "id": "c05a595b-2661-4142-87b6-8662d035bf3f",
          "name": "Postgres2",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "2d4b3451-19c0-4bd8-b7c3-7345c9aff1f8",
          "name": "Enviar mensagem2",
          "type": "n8n-nodes-base.httpRequest"
        },
        {
          "id": "e089fe34-461d-443e-8f95-80d1b2da4a48",
          "name": "Postgres3",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "0b699df8-cae3-4e1c-bf08-5d351b71b325",
          "name": "Enviar mensagem3",
          "type": "n8n-nodes-base.httpRequest"
        },
        {
          "id": "2ff69857-e567-476e-b398-5c9a5e75fdf1",
          "name": "Postgres4",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "1b45b778-b4d4-4c91-8653-fc6d2ed2ab55",
          "name": "Enviar mensagem4",
          "type": "n8n-nodes-base.httpRequest"
        }
      ],
      "connections": [
        {
          "source": "Webhook",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Verificar Status",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Verificar Status",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Confirmado",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Verificar Status",
          "source_output": "main",
          "source_output_index": 1,
          "target": "Aguardando entrega",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Verificar Status",
          "source_output": "main",
          "source_output_index": 2,
          "target": "Saiu para entrega",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Verificar Status",
          "source_output": "main",
          "source_output_index": 3,
          "target": "Entregue",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Verificar Status",
          "source_output": "main",
          "source_output_index": 4,
          "target": "Cancelado",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Confirmado",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Postgres",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Aguardando entrega",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Postgres2",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Saiu para entrega",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Postgres3",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Entregue",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Postgres4",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Cancelado",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Postgres1",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Postgres1",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Enviar mensagem4",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Postgres",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Enviar mensagem",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Postgres2",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Enviar mensagem1",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Postgres3",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Enviar mensagem2",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Postgres4",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Enviar mensagem3",
          "target_input": "main",
          "target_input_index": 0
        }
      ],
      "triggers": [
        {
          "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
          "node_id": "9e119b9d-ca97-480e-a2cb-bd69c9dd29c4",
          "node_name": "Webhook",
          "type": "n8n-nodes-base.webhook",
          "http_method": "POST",
          "path": "marcio_lanches"
        }
      ],
      "http_requests": [
        {
          "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
          "node_id": "3c800162-67f1-4f9f-b655-a8f73fe576c8",
          "node_name": "Enviar mensagem",
          "method": "POST",
          "url": "=https://evo.hub3ps.com/message/sendText/Hub3Ps",
          "headers": {
            "apikey": "568E9C603169-47FB-AD18-B59C9D296594"
          },
          "body": "={\n  \"number\": \"55{{ $json.telefone }}\",\n  \"text\": \"Seu pedido foi confirmado com sucesso e j\u00e1 est\u00e1 na fila da cozinha. Em breve ele come\u00e7a a ser preparado!\",\n  \"delay\": 4000\n}"
        },
        {
          "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
          "node_id": "05c3181a-2456-4315-a975-f45f7e4418fb",
          "node_name": "Enviar mensagem1",
          "method": "POST",
          "url": "=https://evo.hub3ps.com/message/sendText/Hub3Ps",
          "headers": {
            "apikey": "568E9C603169-47FB-AD18-B59C9D296594"
          },
          "body": "={\n  \"number\": \"55{{ $json.telefone }}\",\n  \"text\": \"Boa not\u00edcia, {{ $json.nome }}! \ud83c\udf54 Seu pedido j\u00e1 ficou pronto e agora est\u00e1 aguardando o entregador. Assim que sair, te aviso!\",\n  \"delay\": 4000\n}"
        },
        {
          "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
          "node_id": "2d4b3451-19c0-4bd8-b7c3-7345c9aff1f8",
          "node_name": "Enviar mensagem2",
          "method": "POST",
          "url": "=https://evo.hub3ps.com/message/sendText/Hub3Ps",
          "headers": {
            "apikey": "568E9C603169-47FB-AD18-B59C9D296594"
          },
          "body": "={\n  \"number\": \"55{{ $json.telefone }}\",\n  \"text\": \"\ud83d\udeb4\u200d\u2642\ufe0f Opa, {{ $json.nome }}! Seu pedido acabou de sair para entrega. Logo logo chega a\u00ed na sua casa, pode ir preparando o apetite! \ud83d\ude0b\",\n  \"delay\": 4000\n}"
        },
        {
          "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
          "node_id": "0b699df8-cae3-4e1c-bf08-5d351b71b325",
          "node_name": "Enviar mensagem3",
          "method": "POST",
          "url": "=https://evo.hub3ps.com/message/sendText/Hub3Ps",
          "headers": {
            "apikey": "568E9C603169-47FB-AD18-B59C9D296594"
          },
          "body": "={\n  \"number\": \"55{{ $json.telefone }}\",\n  \"text\": \"{{ $json.nome }}, acabamos de confirmar que seu pedido foi entregue \u2705. Esperamos que voc\u00ea aproveite muito a refei\u00e7\u00e3o! Obrigado por pedir com a gente. \ud83d\udc9b\",\n  \"delay\": 4000\n}"
        },
        {
          "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
          "node_id": "1b45b778-b4d4-4c91-8653-fc6d2ed2ab55",
          "node_name": "Enviar mensagem4",
          "method": "POST",
          "url": "=https://evo.hub3ps.com/message/sendText/Hub3Ps",
          "headers": {
            "apikey": "568E9C603169-47FB-AD18-B59C9D296594"
          },
          "body": "={\n  \"number\": \"55{{ $json.telefone }}\",\n  \"text\": \"{{ $json.nome }}. \ud83d\ude14 Seu pedido foi cancelado. Se quiser, pode falar com a gente aqui para entendermos melhor ou fazer um novo pedido a qualquer momento. Estamos \u00e0 disposi\u00e7\u00e3o!\",\n  \"delay\": 4000\n}"
        }
      ],
      "postgres_queries": [
        {
          "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
          "node_id": "3c1098ac-9082-4473-92df-2c0589218a69",
          "node_name": "Confirmado",
          "operation": "update",
          "schema": "public",
          "table": "orders",
          "query": null,
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "status": "CONFIRMED",
              "order_id": "={{ $json.body.order_id }}"
            },
            "matchingColumns": [
              "order_id"
            ],
            "schema": [
              {
                "id": "id",
                "displayName": "id",
                "required": false,
                "defaultMatch": true,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "order_id",
                "displayName": "order_id",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "nome",
                "displayName": "nome",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "telefone",
                "displayName": "telefone",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "endereco",
                "displayName": "endereco",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pedido",
                "displayName": "pedido",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "observacoes",
                "displayName": "observacoes",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pagamento",
                "displayName": "pagamento",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "total",
                "displayName": "total",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "created_at",
                "displayName": "created_at",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "dateTime",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "status",
                "displayName": "status",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        {
          "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
          "node_id": "7d1d26e5-a15f-439a-889d-8ed44a17576a",
          "node_name": "Aguardando entrega",
          "operation": "update",
          "schema": "public",
          "table": "orders",
          "query": null,
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "status": "READY_TO_DELIVER",
              "order_id": "={{ $json.body.order_id }}"
            },
            "matchingColumns": [
              "order_id"
            ],
            "schema": [
              {
                "id": "id",
                "displayName": "id",
                "required": false,
                "defaultMatch": true,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "order_id",
                "displayName": "order_id",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "nome",
                "displayName": "nome",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "telefone",
                "displayName": "telefone",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "endereco",
                "displayName": "endereco",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pedido",
                "displayName": "pedido",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "observacoes",
                "displayName": "observacoes",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pagamento",
                "displayName": "pagamento",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "total",
                "displayName": "total",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "created_at",
                "displayName": "created_at",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "dateTime",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "status",
                "displayName": "status",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        {
          "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
          "node_id": "13c43016-22ef-44ec-a482-2d92ac73b2d6",
          "node_name": "Saiu para entrega",
          "operation": "update",
          "schema": "public",
          "table": "orders",
          "query": null,
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "status": "DISPATCHED",
              "order_id": "={{ $json.body.order_id }}"
            },
            "matchingColumns": [
              "order_id"
            ],
            "schema": [
              {
                "id": "id",
                "displayName": "id",
                "required": false,
                "defaultMatch": true,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "order_id",
                "displayName": "order_id",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "nome",
                "displayName": "nome",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "telefone",
                "displayName": "telefone",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "endereco",
                "displayName": "endereco",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pedido",
                "displayName": "pedido",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "observacoes",
                "displayName": "observacoes",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pagamento",
                "displayName": "pagamento",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "total",
                "displayName": "total",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "created_at",
                "displayName": "created_at",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "dateTime",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "status",
                "displayName": "status",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        {
          "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
          "node_id": "bb603380-026f-4aac-ba8c-6d4a11ed78ef",
          "node_name": "Entregue",
          "operation": "update",
          "schema": "public",
          "table": "orders",
          "query": null,
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "status": "CONCLUDED",
              "order_id": "={{ $json.body.order_id }}"
            },
            "matchingColumns": [
              "order_id"
            ],
            "schema": [
              {
                "id": "id",
                "displayName": "id",
                "required": false,
                "defaultMatch": true,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "order_id",
                "displayName": "order_id",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "nome",
                "displayName": "nome",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "telefone",
                "displayName": "telefone",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "endereco",
                "displayName": "endereco",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pedido",
                "displayName": "pedido",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "observacoes",
                "displayName": "observacoes",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pagamento",
                "displayName": "pagamento",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "total",
                "displayName": "total",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "created_at",
                "displayName": "created_at",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "dateTime",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "status",
                "displayName": "status",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        {
          "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
          "node_id": "803ca9bd-1404-499e-b7d9-091c35b19f4f",
          "node_name": "Cancelado",
          "operation": "update",
          "schema": "public",
          "table": "orders",
          "query": null,
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "status": "CANCELLED",
              "order_id": "={{ $json.body.order_id }}"
            },
            "matchingColumns": [
              "order_id"
            ],
            "schema": [
              {
                "id": "id",
                "displayName": "id",
                "required": false,
                "defaultMatch": true,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "order_id",
                "displayName": "order_id",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "nome",
                "displayName": "nome",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "telefone",
                "displayName": "telefone",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "endereco",
                "displayName": "endereco",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pedido",
                "displayName": "pedido",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "observacoes",
                "displayName": "observacoes",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pagamento",
                "displayName": "pagamento",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "total",
                "displayName": "total",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "created_at",
                "displayName": "created_at",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "dateTime",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "status",
                "displayName": "status",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        {
          "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
          "node_id": "b1bb18d3-e418-47ad-81ec-b02d8ad55407",
          "node_name": "Postgres",
          "operation": "select",
          "schema": "public",
          "table": "orders",
          "query": null,
          "where": {
            "values": [
              {
                "column": "order_id",
                "value": "={{ $json.order_id }}"
              }
            ]
          }
        },
        {
          "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
          "node_id": "8e021fef-74ae-49c1-9213-27e37ddabd33",
          "node_name": "Postgres1",
          "operation": "select",
          "schema": "public",
          "table": "orders",
          "query": null,
          "where": {
            "values": [
              {
                "column": "order_id",
                "value": "={{ $json.order_id }}"
              }
            ]
          }
        },
        {
          "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
          "node_id": "c05a595b-2661-4142-87b6-8662d035bf3f",
          "node_name": "Postgres2",
          "operation": "select",
          "schema": "public",
          "table": "orders",
          "query": null,
          "where": {
            "values": [
              {
                "column": "order_id",
                "value": "={{ $json.order_id }}"
              }
            ]
          }
        },
        {
          "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
          "node_id": "e089fe34-461d-443e-8f95-80d1b2da4a48",
          "node_name": "Postgres3",
          "operation": "select",
          "schema": "public",
          "table": "orders",
          "query": null,
          "where": {
            "values": [
              {
                "column": "order_id",
                "value": "={{ $json.order_id }}"
              }
            ]
          }
        },
        {
          "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
          "node_id": "2ff69857-e567-476e-b398-5c9a5e75fdf1",
          "node_name": "Postgres4",
          "operation": "select",
          "schema": "public",
          "table": "orders",
          "query": null,
          "where": {
            "values": [
              {
                "column": "order_id",
                "value": "={{ $json.order_id }}"
              }
            ]
          }
        }
      ],
      "code_nodes": [],
      "whatsapp_messages": [
        {
          "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
          "node_id": "3c800162-67f1-4f9f-b655-a8f73fe576c8",
          "node_name": "Enviar mensagem",
          "key": "jsonBody.text",
          "text": "Seu pedido foi confirmado com sucesso e j\u00e1 est\u00e1 na fila da cozinha. Em breve ele come\u00e7a a ser preparado!"
        },
        {
          "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
          "node_id": "05c3181a-2456-4315-a975-f45f7e4418fb",
          "node_name": "Enviar mensagem1",
          "key": "jsonBody.text",
          "text": "Boa not\u00edcia, {{ $json.nome }}! \ud83c\udf54 Seu pedido j\u00e1 ficou pronto e agora est\u00e1 aguardando o entregador. Assim que sair, te aviso!"
        },
        {
          "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
          "node_id": "2d4b3451-19c0-4bd8-b7c3-7345c9aff1f8",
          "node_name": "Enviar mensagem2",
          "key": "jsonBody.text",
          "text": "\ud83d\udeb4\u200d\u2642\ufe0f Opa, {{ $json.nome }}! Seu pedido acabou de sair para entrega. Logo logo chega a\u00ed na sua casa, pode ir preparando o apetite! \ud83d\ude0b"
        },
        {
          "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
          "node_id": "0b699df8-cae3-4e1c-bf08-5d351b71b325",
          "node_name": "Enviar mensagem3",
          "key": "jsonBody.text",
          "text": "{{ $json.nome }}, acabamos de confirmar que seu pedido foi entregue \u2705. Esperamos que voc\u00ea aproveite muito a refei\u00e7\u00e3o! Obrigado por pedir com a gente. \ud83d\udc9b"
        },
        {
          "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
          "node_id": "1b45b778-b4d4-4c91-8653-fc6d2ed2ab55",
          "node_name": "Enviar mensagem4",
          "key": "jsonBody.text",
          "text": "{{ $json.nome }}. \ud83d\ude14 Seu pedido foi cancelado. Se quiser, pode falar com a gente aqui para entendermos melhor ou fazer um novo pedido a qualquer momento. Estamos \u00e0 disposi\u00e7\u00e3o!"
        }
      ]
    },
    {
      "file": "n8n_workflows/6. Recuperar_pedidos.json",
      "workflow_name": "6. Recuperar_pedidos",
      "workflow_id": "mFq0BWP5LPR12XBK",
      "nodes": [
        {
          "id": "c3656b31-0692-4a7b-9a1a-25b7d9903d31",
          "name": "Schedule Trigger",
          "type": "n8n-nodes-base.scheduleTrigger"
        },
        {
          "id": "5b2f7976-c8fd-4107-bd08-0704998ebcfc",
          "name": "Postgres1",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "45a04e87-cf6a-4ef7-9072-fad172ae7558",
          "name": "Loop Over Items",
          "type": "n8n-nodes-base.splitInBatches"
        },
        {
          "id": "eb44bf6e-74aa-487e-ba99-beb0741a16f5",
          "name": "AI Agent",
          "type": "@n8n/n8n-nodes-langchain.agent"
        },
        {
          "id": "508667e5-181f-42a2-bfa1-3190a4d5c693",
          "name": "Edit Fields",
          "type": "n8n-nodes-base.set"
        },
        {
          "id": "720c20c7-52f4-44c0-a523-4028c19c0d6f",
          "name": "Google Gemini Chat Model",
          "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini"
        },
        {
          "id": "6eb6f9f2-81c5-4354-86e0-d91aa74e5310",
          "name": "Postgres Chat Memory",
          "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat"
        },
        {
          "id": "f54ece1c-4a07-45a8-ab40-3525a6d64b75",
          "name": "Evolution API",
          "type": "n8n-nodes-evolution-api.evolutionApi"
        },
        {
          "id": "cda4a656-afa6-46a0-be8a-a937c19696d8",
          "name": "Postgres",
          "type": "n8n-nodes-base.postgres"
        }
      ],
      "connections": [
        {
          "source": "Schedule Trigger",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Postgres1",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Postgres1",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Loop Over Items",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Loop Over Items",
          "source_output": "main",
          "source_output_index": 1,
          "target": "Edit Fields",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Edit Fields",
          "source_output": "main",
          "source_output_index": 0,
          "target": "AI Agent",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Google Gemini Chat Model",
          "source_output": "ai_languageModel",
          "source_output_index": 0,
          "target": "AI Agent",
          "target_input": "ai_languageModel",
          "target_input_index": 0
        },
        {
          "source": "Postgres Chat Memory",
          "source_output": "ai_memory",
          "source_output_index": 0,
          "target": "AI Agent",
          "target_input": "ai_memory",
          "target_input_index": 0
        },
        {
          "source": "AI Agent",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Evolution API",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Evolution API",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Postgres",
          "target_input": "main",
          "target_input_index": 0
        }
      ],
      "triggers": [],
      "http_requests": [],
      "postgres_queries": [
        {
          "workflow": "6. Recuperar_pedidos",
          "node_id": "5b2f7976-c8fd-4107-bd08-0704998ebcfc",
          "node_name": "Postgres1",
          "operation": "executeQuery",
          "schema": null,
          "table": null,
          "query": "SELECT id, session_id, last_message, last_message_type, updated_at, followup_count\nFROM public.active_sessions\nWHERE status = 'active'\n  AND last_message_type IN ('ai','human')\n  AND updated_at < now() - interval '10 minutes'\n  AND COALESCE(followup_count,0) < 2      -- \u2705 at\u00e9 2-1 tentativas\n  AND followup_sent_at IS NULL            -- \u2705 ainda n\u00e3o retomado neste ciclo\nORDER BY updated_at ASC\nLIMIT 200;"
        },
        {
          "workflow": "6. Recuperar_pedidos",
          "node_id": "6eb6f9f2-81c5-4354-86e0-d91aa74e5310",
          "node_name": "Postgres Chat Memory",
          "operation": null,
          "schema": null,
          "table": null,
          "query": null
        },
        {
          "workflow": "6. Recuperar_pedidos",
          "node_id": "cda4a656-afa6-46a0-be8a-a937c19696d8",
          "node_name": "Postgres",
          "operation": "executeQuery",
          "schema": null,
          "table": null,
          "query": "UPDATE public.active_sessions\nSET\n  last_message       = '{{ String($json.mensagem ?? $json.reply ?? $json.text ?? $json.data?.message?.conversation ?? \"\").replace(/'/g,\"''\") }}',\n  last_message_type  = 'ai',\n  updated_at         = NOW(),\n  followup_sent_at   = NOW(),\n  followup_count     = COALESCE(followup_count, 0) + 1\nWHERE session_id = '{{ $('Edit Fields').item.json.telefone ?? $json.session_id }}'\n  AND status = 'active';"
        }
      ],
      "code_nodes": [],
      "whatsapp_messages": []
    },
    {
      "file": "n8n_workflows/7. Valida\u00e7\u00e3o_Endere\u00e7os.json",
      "workflow_name": "7. Valida\u00e7\u00e3o_Endere\u00e7os",
      "workflow_id": "ZcDaWbp79l09Y0Ej",
      "nodes": [
        {
          "id": "f0da5f92-70ae-491c-a82c-8d5dc8d6684f",
          "name": "Start",
          "type": "n8n-nodes-base.executeWorkflowTrigger"
        },
        {
          "id": "839cd279-5ac3-443a-88cb-d416b31d1a4a",
          "name": "HTTP Request",
          "type": "n8n-nodes-base.httpRequest"
        },
        {
          "id": "9c1e6dd8-5afa-41f6-a95a-ccbe37a1f891",
          "name": "Code in JavaScript",
          "type": "n8n-nodes-base.code"
        }
      ],
      "connections": [
        {
          "source": "Start",
          "source_output": "main",
          "source_output_index": 0,
          "target": "HTTP Request",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "HTTP Request",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Code in JavaScript",
          "target_input": "main",
          "target_input_index": 0
        }
      ],
      "triggers": [],
      "http_requests": [
        {
          "workflow": "7. Valida\u00e7\u00e3o_Endere\u00e7os",
          "node_id": "839cd279-5ac3-443a-88cb-d416b31d1a4a",
          "node_name": "HTTP Request",
          "method": null,
          "url": "https://maps.googleapis.com/maps/api/geocode/json",
          "headers": null,
          "body": null
        }
      ],
      "postgres_queries": [],
      "code_nodes": [
        {
          "workflow": "7. Valida\u00e7\u00e3o_Endere\u00e7os",
          "node_id": "9c1e6dd8-5afa-41f6-a95a-ccbe37a1f891",
          "node_name": "Code in JavaScript",
          "language": "javascript",
          "snippet": "const components = $input.first().json.results[0].address_components;\n\nconst findByType = (types) => {\n  const item = components.find(c => types.some(t => c.types.includes(t)));\n  return item?.long_name || null;\n};\n\nreturn {\n  json: {\n    rua: findByType(['route']),\n    numero: findByType(['street_n\u2026"
        }
      ],
      "whatsapp_messages": []
    },
    {
      "file": "n8n_workflows/Atualiza Card\u00e1pio.json",
      "workflow_name": "Atualiza Card\u00e1pio",
      "workflow_id": "hSHAcVFJhESI95re",
      "nodes": [
        {
          "id": "54314f11-93e9-435a-b99b-fe53480ffb2c",
          "name": "consulta_cardapio",
          "type": "n8n-nodes-base.httpRequest"
        },
        {
          "id": "08d3540c-5160-447f-a417-4de5e3517aea",
          "name": "Schedule Trigger",
          "type": "n8n-nodes-base.scheduleTrigger"
        },
        {
          "id": "8d7ffbef-c426-40bd-8b97-3f9b55a8a2f0",
          "name": "Code in JavaScript",
          "type": "n8n-nodes-base.code"
        },
        {
          "id": "ce20c0b0-c35a-45cb-95e8-e48a3d797dda",
          "name": "Execute a SQL query",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "0e3eb3f8-9881-412f-9471-362ff3d7178e",
          "name": "Insert rows in a table",
          "type": "n8n-nodes-base.postgres"
        }
      ],
      "connections": [
        {
          "source": "Schedule Trigger",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Execute a SQL query",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "consulta_cardapio",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Code in JavaScript",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Code in JavaScript",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Insert rows in a table",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Execute a SQL query",
          "source_output": "main",
          "source_output_index": 0,
          "target": "consulta_cardapio",
          "target_input": "main",
          "target_input_index": 0
        }
      ],
      "triggers": [],
      "http_requests": [
        {
          "workflow": "Atualiza Card\u00e1pio",
          "node_id": "54314f11-93e9-435a-b99b-fe53480ffb2c",
          "node_name": "consulta_cardapio",
          "method": null,
          "url": "https://order-api.saipos.com/catalog",
          "headers": {
            "Authorization": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZFBhcnRuZXIiOiI0NzJkMjZhYzU0OGIwZTk3YjdjM2E0ZGZhYTMxZjlhNSIsImNyZWF0ZWQiOjE3NjU5MDc5NjQ0NDksImlhdCI6MTc2NTkwNzk2NCwiZXhwIjoxNzY2MDgwNzY0fQ.mtyuz9t_vbgXce19Ai3T7A8_wLONdEgS4A9oDeKx0fU",
            "accept": "application/json"
          },
          "body": null
        }
      ],
      "postgres_queries": [
        {
          "workflow": "Atualiza Card\u00e1pio",
          "node_id": "ce20c0b0-c35a-45cb-95e8-e48a3d797dda",
          "node_name": "Execute a SQL query",
          "operation": "executeQuery",
          "schema": null,
          "table": null,
          "query": "DELETE FROM public.saipos_menu_raw\nWHERE client_id = '06a81600-26fc-472b-880e-e6293943354e'::uuid;"
        },
        {
          "workflow": "Atualiza Card\u00e1pio",
          "node_id": "0e3eb3f8-9881-412f-9471-362ff3d7178e",
          "node_name": "Insert rows in a table",
          "operation": null,
          "schema": "public",
          "table": "saipos_menu_raw",
          "query": null,
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "client_id": "={{ $json.client_id }}",
              "tipo": "={{ $json.tipo }}",
              "categoria": "={{ $json.categoria }}",
              "tamanho": "={{ $json.tamanho }}",
              "id_store_item": "={{ $json.id_store_item }}",
              "item": "={{ $json.item }}",
              "id_store_choice": "={{ $json.id_store_choice }}",
              "complemento": "={{ $json.complemento }}",
              "complemento_item": "={{ $json.complemento_item }}",
              "price": "={{ $json.price }}",
              "codigo_saipos": "={{ $json.codigo_saipos }}",
              "store_item_enabled": "={{ $json.store_item_enabled }}",
              "store_choice_enabled": "={{ $json.store_choice_enabled }}",
              "store_choice_item_enabled": "={{ $json.store_choice_item_enabled }}",
              "item_type": "={{ $json.item_type }}",
              "pdv_code": "={{ $json.pdv_code }}",
              "parent_pdv_code": "={{ $json.parent_pdv_code }}",
              "created_at": "2025-12-16T18:08:17"
            },
            "matchingColumns": [
              "id"
            ],
            "schema": [
              {
                "id": "id",
                "displayName": "id",
                "required": false,
                "defaultMatch": true,
                "display": true,
                "type": "number",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "client_id",
                "displayName": "client_id",
                "required": true,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "tipo",
                "displayName": "tipo",
                "required": true,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "categoria",
                "displayName": "categoria",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "tamanho",
                "displayName": "tamanho",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "id_store_item",
                "displayName": "id_store_item",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "number",
                "canBeUsedToMatch": true
              },
              {
                "id": "item",
                "displayName": "item",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "id_store_choice",
                "displayName": "id_store_choice",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "number",
                "canBeUsedToMatch": true
              },
              {
                "id": "complemento",
                "displayName": "complemento",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "complemento_item",
                "displayName": "complemento_item",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "price",
                "displayName": "price",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "number",
                "canBeUsedToMatch": true
              },
              {
                "id": "codigo_saipos",
                "displayName": "codigo_saipos",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "store_item_enabled",
                "displayName": "store_item_enabled",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "store_choice_enabled",
                "displayName": "store_choice_enabled",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "store_choice_item_enabled",
                "displayName": "store_choice_item_enabled",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "item_type",
                "displayName": "item_type",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "pdv_code",
                "displayName": "pdv_code",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "parent_pdv_code",
                "displayName": "parent_pdv_code",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "created_at",
                "displayName": "created_at",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "dateTime",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        }
      ],
      "code_nodes": [
        {
          "workflow": "Atualiza Card\u00e1pio",
          "node_id": "8d7ffbef-c426-40bd-8b97-3f9b55a8a2f0",
          "node_name": "Code in JavaScript",
          "language": "javascript",
          "snippet": "const CLIENT_ID = '06a81600-26fc-472b-880e-e6293943354e';\n\nconst items = $input.all(); // pega todos os itens do HTTP Request\n\nconst result = [];\n\nfor (const item of items) {\n  const row = item.json; // linha original da Saipos\n\n  const codigo = row.codigo_saipos || null;\n\n  // pdv_code = c\u00f3digo com\u2026"
        }
      ],
      "whatsapp_messages": []
    },
    {
      "file": "n8n_workflows/Enviar_pedido.json",
      "workflow_name": "Enviar_pedido",
      "workflow_id": "lXCs4Uwq5nn0h0pD",
      "nodes": [
        {
          "id": "49a0d126-91c1-43be-89cd-201c7074718a",
          "name": "Webhook",
          "type": "n8n-nodes-base.webhook"
        },
        {
          "id": "5781eed6-c595-449f-a637-cb48214601d7",
          "name": "Enviar_pedido_Saipos",
          "type": "n8n-nodes-base.httpRequest"
        },
        {
          "id": "f83c929b-997d-45aa-9782-34445fc5dc80",
          "name": "Salva_pedido_banco",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "e291e237-df8b-439a-b6cf-7c2792321e5e",
          "name": "Wait",
          "type": "n8n-nodes-base.wait"
        },
        {
          "id": "4364169f-1680-46b0-8c72-5e73799a9e9d",
          "name": "active_sessions_finished",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "abb0dea4-389c-486b-93f4-e97a3184ff2d",
          "name": "Sticky Note",
          "type": "n8n-nodes-base.stickyNote"
        },
        {
          "id": "901b57b7-33f7-4ff0-9ad5-fa892329b1c8",
          "name": "Search Index",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "7c50fc56-1f4b-45e4-bd50-0818a0e4a5c6",
          "name": "Match Fingerprint",
          "type": "n8n-nodes-base.code"
        },
        {
          "id": "fd9921c4-bba0-41ae-8c12-b9ee43479319",
          "name": "Formatar JSON Saipos",
          "type": "n8n-nodes-base.code"
        }
      ],
      "connections": [
        {
          "source": "Webhook",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Search Index",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Enviar_pedido_Saipos",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Wait",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Salva_pedido_banco",
          "source_output": "main",
          "source_output_index": 0,
          "target": "active_sessions_finished",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Wait",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Salva_pedido_banco",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Search Index",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Match Fingerprint",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Match Fingerprint",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Formatar JSON Saipos",
          "target_input": "main",
          "target_input_index": 0
        }
      ],
      "triggers": [
        {
          "workflow": "Enviar_pedido",
          "node_id": "49a0d126-91c1-43be-89cd-201c7074718a",
          "node_name": "Webhook",
          "type": "n8n-nodes-base.webhook",
          "http_method": "POST",
          "path": "enviar-pedido"
        }
      ],
      "http_requests": [
        {
          "workflow": "Enviar_pedido",
          "node_id": "5781eed6-c595-449f-a637-cb48214601d7",
          "node_name": "Enviar_pedido_Saipos",
          "method": "POST",
          "url": "https://order-api.saipos.com/order",
          "headers": {
            "content-type": "application/json",
            "Authorization": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZFBhcnRuZXIiOiI0NzJkMjZhYzU0OGIwZTk3YjdjM2E0ZGZhYTMxZjlhNSIsImNyZWF0ZWQiOjE3NjA5ODExNjgwMjgsImlhdCI6MTc2MDk4MTE2OCwiZXhwIjoxNzYxMTUzOTY4fQ.kPX7ooLGesv1YP6qLzHdAkqC_TPlhDh5AdEpEe3mkco",
            "accept": "application/json"
          },
          "body": "={{ $json }}"
        }
      ],
      "postgres_queries": [
        {
          "workflow": "Enviar_pedido",
          "node_id": "f83c929b-997d-45aa-9782-34445fc5dc80",
          "node_name": "Salva_pedido_banco",
          "operation": "executeQuery",
          "schema": null,
          "table": null,
          "query": "SELECT public.upsert_delivery_batch('{{ JSON.stringify([$json]) }}'::jsonb);"
        },
        {
          "workflow": "Enviar_pedido",
          "node_id": "4364169f-1680-46b0-8c72-5e73799a9e9d",
          "node_name": "active_sessions_finished",
          "operation": "executeQuery",
          "schema": null,
          "table": null,
          "query": "UPDATE public.active_sessions\nSET \n  status = 'finished',\n  updated_at = NOW()\nWHERE session_id = '{{ $json.customer.id || $json.session_id }}'\n  AND status = 'active';\n"
        },
        {
          "workflow": "Enviar_pedido",
          "node_id": "901b57b7-33f7-4ff0-9ad5-fa892329b1c8",
          "node_name": "Search Index",
          "operation": "executeQuery",
          "schema": null,
          "table": null,
          "query": "SELECT * FROM v_menu_search_index;"
        }
      ],
      "code_nodes": [
        {
          "workflow": "Enviar_pedido",
          "node_id": "7c50fc56-1f4b-45e4-bd50-0818a0e4a5c6",
          "node_name": "Match Fingerprint",
          "language": "javascript",
          "snippet": "// ============================================================\n// 1. PREPARA\u00c7\u00c3O DOS DADOS\n// ============================================================\n\n// Recebe o pedido do n\u00f3 Webhook\nconst pedidoOriginal = $('Webhook').first().json.body; \n\n// Recebe o \u00edndice de busca do banco\nconst indiceBanco\u2026"
        },
        {
          "workflow": "Enviar_pedido",
          "node_id": "fd9921c4-bba0-41ae-8c12-b9ee43479319",
          "node_name": "Formatar JSON Saipos",
          "language": "javascript",
          "snippet": "// ========== DEBUG: Visualizar estrutura do input ==========\n// Descomente as linhas abaixo para ver o que est\u00e1 chegando\n// console.log(\"items completo:\", JSON.stringify(items, null, 2));\n// console.log(\"items[0]:\", JSON.stringify(items[0], null, 2));\n\n// Pega o JSON que vem do agente de IA\n// Test\u2026"
        }
      ],
      "whatsapp_messages": []
    },
    {
      "file": "n8n_workflows/Gerar Embeddings Card\u00e1pio.json",
      "workflow_name": "Gerar Embeddings Card\u00e1pio",
      "workflow_id": "JZoVRURwZktCAEQz",
      "nodes": [
        {
          "id": "6323229a-c2ec-450f-bcb5-c026cc4574af",
          "name": "Supabase - Buscar Itens",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "dd39f683-68ee-45a3-a459-58c48547b2ff",
          "name": "Supabase - Inserir",
          "type": "n8n-nodes-base.postgres"
        },
        {
          "id": "fde00433-a3f4-4be3-82e4-07c4710dadfd",
          "name": "Loop Over Items1",
          "type": "n8n-nodes-base.splitInBatches"
        },
        {
          "id": "64d25dcc-39fa-444f-83f6-8802df1323ce",
          "name": "When clicking \u2018Execute workflow\u2019",
          "type": "n8n-nodes-base.manualTrigger"
        },
        {
          "id": "544bb0c4-7a17-4334-85b3-106fde0cb2aa",
          "name": "HTTP Request",
          "type": "n8n-nodes-base.httpRequest"
        },
        {
          "id": "07a43228-7109-4636-b22a-6cca4a0fc13c",
          "name": "Code in JavaScript",
          "type": "n8n-nodes-base.code"
        }
      ],
      "connections": [
        {
          "source": "Supabase - Buscar Itens",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Loop Over Items1",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Supabase - Inserir",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Loop Over Items1",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Loop Over Items1",
          "source_output": "main",
          "source_output_index": 1,
          "target": "HTTP Request",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "When clicking \u2018Execute workflow\u2019",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Supabase - Buscar Itens",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "HTTP Request",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Code in JavaScript",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Code in JavaScript",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Supabase - Inserir",
          "target_input": "main",
          "target_input_index": 0
        }
      ],
      "triggers": [],
      "http_requests": [
        {
          "workflow": "Gerar Embeddings Card\u00e1pio",
          "node_id": "544bb0c4-7a17-4334-85b3-106fde0cb2aa",
          "node_name": "HTTP Request",
          "method": "POST",
          "url": "https://api.openai.com/v1/embeddings",
          "headers": null,
          "body": "={\n  \"model\": \"text-embedding-3-small\",\n  \"input\": \"={{ $json.display_name }}\"\n}"
        }
      ],
      "postgres_queries": [
        {
          "workflow": "Gerar Embeddings Card\u00e1pio",
          "node_id": "6323229a-c2ec-450f-bcb5-c026cc4574af",
          "node_name": "Supabase - Buscar Itens",
          "operation": "executeQuery",
          "schema": null,
          "table": null,
          "query": "-- Buscar itens\nSELECT \n    item_id::text,\n    pdv,\n    display_name,\n    category,\n    price::numeric\nFROM v_menu_catalog \nWHERE active = true\nORDER BY category, display_name;"
        },
        {
          "workflow": "Gerar Embeddings Card\u00e1pio",
          "node_id": "dd39f683-68ee-45a3-a459-58c48547b2ff",
          "node_name": "Supabase - Inserir",
          "operation": "executeQuery",
          "schema": null,
          "table": null,
          "query": "{{ $json.query }}"
        }
      ],
      "code_nodes": [
        {
          "workflow": "Gerar Embeddings Card\u00e1pio",
          "node_id": "07a43228-7109-4636-b22a-6cca4a0fc13c",
          "node_name": "Code in JavaScript",
          "language": "javascript",
          "snippet": "const item = $('Loop Over Items1').item.json;\nconst embedding = $json.data[0].embedding;\n\nconst escapeSql = (str) => str.replace(/'/g, \"''\");\n\nconst query = `\nINSERT INTO menu_embeddings \n(pdv, display_name, category, price, embedding)\nVALUES \n(\n  '${escapeSql(item.pdv)}',\n  '${escapeSql(item.displa\u2026"
        }
      ],
      "whatsapp_messages": []
    },
    {
      "file": "n8n_workflows/Token_Saipos.json",
      "workflow_name": "Token_Saipos",
      "workflow_id": "E2kbjvJbkQj71SKs",
      "nodes": [
        {
          "id": "daad98bc-6677-4617-b439-77fcfdd0a31b",
          "name": "Token de Autoriza\u00e7\u00e3o",
          "type": "n8n-nodes-base.httpRequest"
        },
        {
          "id": "72b5ea2e-a0a1-4ad3-9e49-5090067966a3",
          "name": "When clicking \u2018Execute workflow\u2019",
          "type": "n8n-nodes-base.manualTrigger"
        }
      ],
      "connections": [
        {
          "source": "When clicking \u2018Execute workflow\u2019",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Token de Autoriza\u00e7\u00e3o",
          "target_input": "main",
          "target_input_index": 0
        }
      ],
      "triggers": [],
      "http_requests": [
        {
          "workflow": "Token_Saipos",
          "node_id": "daad98bc-6677-4617-b439-77fcfdd0a31b",
          "node_name": "Token de Autoriza\u00e7\u00e3o",
          "method": "POST",
          "url": "https://order-api.saipos.com/auth",
          "headers": {
            "Content-Type": "application/json",
            "Accept": "application/json"
          },
          "body": "={\n  \"idPartner\": \"472d26ac548b0e97b7c3a4dfaa31f9a5\",\n  \"secret\": \"b7e1ceaa4d3637b0e4b20df9ef792e3d\"\n}"
        }
      ],
      "postgres_queries": [],
      "code_nodes": [],
      "whatsapp_messages": []
    },
    {
      "file": "n8n_workflows/Webhook_Central_Saipos.json",
      "workflow_name": "Webhook_Central_Saipos",
      "workflow_id": "cfsDYUT0163acKeA",
      "nodes": [
        {
          "id": "833758ef-ccca-48c5-b193-01bbeb18b937",
          "name": "Webhook",
          "type": "n8n-nodes-base.webhook"
        },
        {
          "id": "e171ed9c-a76d-42cc-85e7-04d3f1e76d9b",
          "name": "Switch",
          "type": "n8n-nodes-base.switch"
        },
        {
          "id": "bad994c6-d1ad-45c4-936d-1ffe431a862f",
          "name": "M\u00e1rcio Lanches",
          "type": "n8n-nodes-base.httpRequest"
        }
      ],
      "connections": [
        {
          "source": "Webhook",
          "source_output": "main",
          "source_output_index": 0,
          "target": "Switch",
          "target_input": "main",
          "target_input_index": 0
        },
        {
          "source": "Switch",
          "source_output": "main",
          "source_output_index": 0,
          "target": "M\u00e1rcio Lanches",
          "target_input": "main",
          "target_input_index": 0
        }
      ],
      "triggers": [
        {
          "workflow": "Webhook_Central_Saipos",
          "node_id": "833758ef-ccca-48c5-b193-01bbeb18b937",
          "node_name": "Webhook",
          "type": "n8n-nodes-base.webhook",
          "http_method": "POST",
          "path": "saipos-central"
        }
      ],
      "http_requests": [
        {
          "workflow": "Webhook_Central_Saipos",
          "node_id": "bad994c6-d1ad-45c4-936d-1ffe431a862f",
          "node_name": "M\u00e1rcio Lanches",
          "method": "POST",
          "url": "https://webhook.hub3ps.com/webhook/marcio_lanches",
          "headers": null,
          "body": "={{ $json.body }}"
        }
      ],
      "postgres_queries": [],
      "code_nodes": [],
      "whatsapp_messages": []
    }
  ],
  "nodes": [
    {
      "workflow": "1. Lia_V3.1",
      "id": "f3a917f8-b7d2-4769-aeb1-f4d9b303fedd",
      "name": "Mensagem chegando?",
      "type": "n8n-nodes-base.filter"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "dc69fb75-17b4-4574-9d60-daded7b65374",
      "name": "Mensagem recebida",
      "type": "n8n-nodes-base.webhook"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "8fa19d54-ae6f-40d4-bcc2-549a1d157b65",
      "name": "Mensagem encavalada?",
      "type": "n8n-nodes-base.code"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "f5bb5b9c-0109-4906-9367-48df87c660d9",
      "name": "Buscar mensagens",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "c8d9ec83-6542-43ce-ad23-fa3e429428b5",
      "name": "Concatenar mensagens",
      "type": "n8n-nodes-base.set"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "a51493d4-efb0-4ba2-ae4c-606163a40c2f",
      "name": "Limpar fila de mensagens",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "4ccb67d7-5c10-482f-aa29-324532f71fc5",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "67043511-8db6-475a-bd66-f55d73ce0d7b",
      "name": "Esperar",
      "type": "n8n-nodes-base.wait"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "e8126e5e-cbd4-446a-b520-4ae19782ed4b",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "e158c0f9-6e8b-4903-9813-a5c2adcdc5ca",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "daab215a-0aaf-44b5-bd92-5dadd39ff37e",
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "d291e5e3-902c-4631-86be-9f9a1b93dfff",
      "name": "Tipo de mensagem",
      "type": "n8n-nodes-base.switch"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "2b8ba7b0-f6d5-43b3-8b20-d880edfee428",
      "name": "Transcrever \u00e1udio",
      "type": "@n8n/n8n-nodes-langchain.openAi"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "f02d2e6e-159b-4b2e-a2d4-0082d9613d98",
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "72e5ffd6-df7e-4136-bbb9-dab0bde9c246",
      "name": "Resetar status",
      "type": "n8n-nodes-evolution-api.evolutionApi"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "8bc6d117-b93d-4e76-8129-04f5c2e172dc",
      "name": "Converter \u00e1udio para base64",
      "type": "n8n-nodes-base.extractFromFile"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "21dfa125-530b-4a6d-81d0-6e7825c23c36",
      "name": "Sticky Note12",
      "type": "n8n-nodes-base.stickyNote"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "700ef2a7-4535-4798-b20e-adc8b7b77f06",
      "name": "Gerar \u00e1udio",
      "type": "n8n-nodes-base.httpRequest"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "a525e6fe-8331-41bc-996e-cd7eedf20128",
      "name": "Formatar SSML",
      "type": "@n8n/n8n-nodes-langchain.chainLlm"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "d3cd199a-38d9-4308-889a-4358f97c249f",
      "name": "Tipo de mensagem1",
      "type": "n8n-nodes-base.switch"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "f2b4fa71-067e-41df-9241-0585f654e9bf",
      "name": "Memory",
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "3ba92b3e-5219-4c81-9b45-00b594602203",
      "name": "Responder mensagem \u00e1udio",
      "type": "n8n-nodes-evolution-api.evolutionApi"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "14e3ef56-d059-4507-926f-ae5869fb93ec",
      "name": "Converter base64 para \u00e1udio.",
      "type": "n8n-nodes-base.convertToFile"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "30db27c0-35c3-4e26-882a-14fc0a5f4828",
      "name": "Enfileirar mensagem.",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "4832ba2c-efff-4989-93ad-d4616015efeb",
      "name": "Google Gemini Chat Model.",
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "f7eb1080-324f-4508-9dc7-0757b857514e",
      "name": "Info",
      "type": "n8n-nodes-base.set"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "7614af66-47bd-49d6-b03b-a4ae5201a259",
      "name": "cancelar_pedido",
      "type": "n8n-nodes-base.httpRequestTool"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "4e62e363-6d65-4f98-a59b-b602b5c5725e",
      "name": "Code",
      "type": "n8n-nodes-base.code"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "7680728b-a97a-40b1-bd92-37ec4c106c98",
      "name": "Loop Over Items",
      "type": "n8n-nodes-base.splitInBatches"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "9d3d1c90-f2ee-4380-8b8b-6badc0bb4470",
      "name": "HTTP Request",
      "type": "n8n-nodes-base.httpRequest"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "1df8c600-732e-40d9-ac4b-2ab1a7321c81",
      "name": "HTTP Request1",
      "type": "n8n-nodes-base.httpRequest"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "31cdc6e0-4b2c-4700-b7e2-aee3deb384d3",
      "name": "HTTP Request2",
      "type": "n8n-nodes-base.httpRequest"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "3b9ce552-7cf4-4650-ba27-e61e97e5e6cd",
      "name": "Marcar como lida texto",
      "type": "n8n-nodes-evolution-api.evolutionApi"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "b3638eae-e47e-4dfe-94d0-3c8b577cb64d",
      "name": "controle atendimentos",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "9e09756c-5e31-4387-8665-39bdd0d913c2",
      "name": "atualiza atendimento",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "4e3dec4b-34cd-4576-81c7-56c8e907d3fc",
      "name": "Marcar como lida audio",
      "type": "n8n-nodes-evolution-api.evolutionApi"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "85fbcfb1-8427-4482-a34f-d56164231287",
      "name": "controle atendimentos1",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "25ca5262-c729-4127-8b8e-ac57ea758b6d",
      "name": "Convert to File",
      "type": "n8n-nodes-base.convertToFile"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "a00b60df-b19a-4b1c-a588-466059385342",
      "name": "OpenAI",
      "type": "@n8n/n8n-nodes-langchain.openAi"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "ae694ad5-fddc-4287-ac52-0a82006f75a9",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "4f01ea44-7ddd-421f-8801-458dc94b83bd",
      "name": "Marcar como lida audio1",
      "type": "n8n-nodes-evolution-api.evolutionApi"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "ba5e58a4-adae-4005-9b03-586f59cd601c",
      "name": "controle atendimentos2",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "ddeb99a3-9f98-46a5-a2e7-98296d1f2916",
      "name": "Atendente",
      "type": "@n8n/n8n-nodes-langchain.agent"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "bff1176e-4b56-4ed1-9898-4df7de5d56a0",
      "name": "taxa_entrega",
      "type": "n8n-nodes-base.postgresTool"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "bc46ec9c-3751-45e4-81d6-7702aed9fb81",
      "name": "Chat Memory Manager",
      "type": "@n8n/n8n-nodes-langchain.memoryManager"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "2aef5b99-c5a8-483f-854f-dbcbb26d6529",
      "name": "Postgres Chat Memory",
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "3c552c81-3f61-41cf-bf9a-101ca6101290",
      "name": "When clicking \u2018Execute workflow\u2019",
      "type": "n8n-nodes-base.manualTrigger"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "c6883af4-5819-4d6f-9dd8-527667aa4b83",
      "name": "OpenAI2",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "4fb97b33-5ff7-4220-a77a-29f562f767be",
      "name": "Convert to File2",
      "type": "n8n-nodes-base.convertToFile"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "ef10f770-3ae2-4bde-83f5-9fafd28cd05e",
      "name": "enviar_pedido",
      "type": "n8n-nodes-base.httpRequestTool"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "21514567-6f4f-41f0-bcf1-e3e568587a4f",
      "name": "Convert to File1",
      "type": "n8n-nodes-base.convertToFile"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "ed8fbb5c-1cf1-4717-8832-42bfd2398c02",
      "name": "Analyze document",
      "type": "@n8n/n8n-nodes-langchain.googleGemini"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "0258b464-472f-4234-90aa-468d16a62a3a",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "e20150ff-8eae-4e95-a00a-4dafe9964701",
      "name": "Marcar como lida audio2",
      "type": "n8n-nodes-evolution-api.evolutionApi"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "d0d2155e-1872-497f-83a6-35d4a28d0800",
      "name": "controle atendimentos3",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "320dcae4-754d-4b0b-b160-b464759054ac",
      "name": "calcular_totais",
      "type": "@n8n/n8n-nodes-langchain.toolCode"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "bc148a11-c7ec-4d68-933d-7248c4e93e3b",
      "name": "Execution Data",
      "type": "n8n-nodes-base.executionData"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "73651afc-3948-484e-b463-34573ef27296",
      "name": "stages",
      "type": "n8n-nodes-base.postgresTool"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "2459e30e-3c76-4a5b-bd0d-b71997a91b08",
      "name": "cardapio",
      "type": "n8n-nodes-base.postgresTool"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "e990fbf6-c983-4a5d-baaa-a0de3fad5105",
      "name": "maps",
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "bfd2d491-bf3f-4f27-8be9-2146d577d0d1",
      "name": "Sticky Note13",
      "type": "n8n-nodes-base.stickyNote"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "695d18fd-e05f-486c-bd18-e4a2b72ee1e3",
      "name": "liberado",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "4ef66efc-6856-4ffe-9369-e51fc2c726b2",
      "name": "humano assumiu",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "a3dfd2e7-d160-433b-b4a2-568e8243a834",
      "name": "Filtro de Remetente",
      "type": "n8n-nodes-base.if"
    },
    {
      "workflow": "1. Lia_V3.1",
      "id": "a37af949-52e3-4e52-9a13-93781355bdf5",
      "name": "historico1",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "4. Cancelar_pedido",
      "id": "b33d1e3c-934b-4bd9-9b7a-632312017a13",
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook"
    },
    {
      "workflow": "4. Cancelar_pedido",
      "id": "b0e779e2-f9bb-4136-ba17-74b5b8309f8d",
      "name": "Postgres",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "4. Cancelar_pedido",
      "id": "43cf27e3-6f9f-4abc-aecd-d46b0290a7c1",
      "name": "HTTP Request",
      "type": "n8n-nodes-base.httpRequest"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "id": "9e119b9d-ca97-480e-a2cb-bd69c9dd29c4",
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "id": "47cc30d8-7a80-4483-96b7-b4602083d136",
      "name": "Verificar Status",
      "type": "n8n-nodes-base.switch"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "id": "3c1098ac-9082-4473-92df-2c0589218a69",
      "name": "Confirmado",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "id": "7d1d26e5-a15f-439a-889d-8ed44a17576a",
      "name": "Aguardando entrega",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "id": "13c43016-22ef-44ec-a482-2d92ac73b2d6",
      "name": "Saiu para entrega",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "id": "bb603380-026f-4aac-ba8c-6d4a11ed78ef",
      "name": "Entregue",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "id": "803ca9bd-1404-499e-b7d9-091c35b19f4f",
      "name": "Cancelado",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "id": "b1bb18d3-e418-47ad-81ec-b02d8ad55407",
      "name": "Postgres",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "id": "8e021fef-74ae-49c1-9213-27e37ddabd33",
      "name": "Postgres1",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "id": "3c800162-67f1-4f9f-b655-a8f73fe576c8",
      "name": "Enviar mensagem",
      "type": "n8n-nodes-base.httpRequest"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "id": "05c3181a-2456-4315-a975-f45f7e4418fb",
      "name": "Enviar mensagem1",
      "type": "n8n-nodes-base.httpRequest"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "id": "c05a595b-2661-4142-87b6-8662d035bf3f",
      "name": "Postgres2",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "id": "2d4b3451-19c0-4bd8-b7c3-7345c9aff1f8",
      "name": "Enviar mensagem2",
      "type": "n8n-nodes-base.httpRequest"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "id": "e089fe34-461d-443e-8f95-80d1b2da4a48",
      "name": "Postgres3",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "id": "0b699df8-cae3-4e1c-bf08-5d351b71b325",
      "name": "Enviar mensagem3",
      "type": "n8n-nodes-base.httpRequest"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "id": "2ff69857-e567-476e-b398-5c9a5e75fdf1",
      "name": "Postgres4",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "id": "1b45b778-b4d4-4c91-8653-fc6d2ed2ab55",
      "name": "Enviar mensagem4",
      "type": "n8n-nodes-base.httpRequest"
    },
    {
      "workflow": "6. Recuperar_pedidos",
      "id": "c3656b31-0692-4a7b-9a1a-25b7d9903d31",
      "name": "Schedule Trigger",
      "type": "n8n-nodes-base.scheduleTrigger"
    },
    {
      "workflow": "6. Recuperar_pedidos",
      "id": "5b2f7976-c8fd-4107-bd08-0704998ebcfc",
      "name": "Postgres1",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "6. Recuperar_pedidos",
      "id": "45a04e87-cf6a-4ef7-9072-fad172ae7558",
      "name": "Loop Over Items",
      "type": "n8n-nodes-base.splitInBatches"
    },
    {
      "workflow": "6. Recuperar_pedidos",
      "id": "eb44bf6e-74aa-487e-ba99-beb0741a16f5",
      "name": "AI Agent",
      "type": "@n8n/n8n-nodes-langchain.agent"
    },
    {
      "workflow": "6. Recuperar_pedidos",
      "id": "508667e5-181f-42a2-bfa1-3190a4d5c693",
      "name": "Edit Fields",
      "type": "n8n-nodes-base.set"
    },
    {
      "workflow": "6. Recuperar_pedidos",
      "id": "720c20c7-52f4-44c0-a523-4028c19c0d6f",
      "name": "Google Gemini Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini"
    },
    {
      "workflow": "6. Recuperar_pedidos",
      "id": "6eb6f9f2-81c5-4354-86e0-d91aa74e5310",
      "name": "Postgres Chat Memory",
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat"
    },
    {
      "workflow": "6. Recuperar_pedidos",
      "id": "f54ece1c-4a07-45a8-ab40-3525a6d64b75",
      "name": "Evolution API",
      "type": "n8n-nodes-evolution-api.evolutionApi"
    },
    {
      "workflow": "6. Recuperar_pedidos",
      "id": "cda4a656-afa6-46a0-be8a-a937c19696d8",
      "name": "Postgres",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "7. Valida\u00e7\u00e3o_Endere\u00e7os",
      "id": "f0da5f92-70ae-491c-a82c-8d5dc8d6684f",
      "name": "Start",
      "type": "n8n-nodes-base.executeWorkflowTrigger"
    },
    {
      "workflow": "7. Valida\u00e7\u00e3o_Endere\u00e7os",
      "id": "839cd279-5ac3-443a-88cb-d416b31d1a4a",
      "name": "HTTP Request",
      "type": "n8n-nodes-base.httpRequest"
    },
    {
      "workflow": "7. Valida\u00e7\u00e3o_Endere\u00e7os",
      "id": "9c1e6dd8-5afa-41f6-a95a-ccbe37a1f891",
      "name": "Code in JavaScript",
      "type": "n8n-nodes-base.code"
    },
    {
      "workflow": "Atualiza Card\u00e1pio",
      "id": "54314f11-93e9-435a-b99b-fe53480ffb2c",
      "name": "consulta_cardapio",
      "type": "n8n-nodes-base.httpRequest"
    },
    {
      "workflow": "Atualiza Card\u00e1pio",
      "id": "08d3540c-5160-447f-a417-4de5e3517aea",
      "name": "Schedule Trigger",
      "type": "n8n-nodes-base.scheduleTrigger"
    },
    {
      "workflow": "Atualiza Card\u00e1pio",
      "id": "8d7ffbef-c426-40bd-8b97-3f9b55a8a2f0",
      "name": "Code in JavaScript",
      "type": "n8n-nodes-base.code"
    },
    {
      "workflow": "Atualiza Card\u00e1pio",
      "id": "ce20c0b0-c35a-45cb-95e8-e48a3d797dda",
      "name": "Execute a SQL query",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "Atualiza Card\u00e1pio",
      "id": "0e3eb3f8-9881-412f-9471-362ff3d7178e",
      "name": "Insert rows in a table",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "Enviar_pedido",
      "id": "49a0d126-91c1-43be-89cd-201c7074718a",
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook"
    },
    {
      "workflow": "Enviar_pedido",
      "id": "5781eed6-c595-449f-a637-cb48214601d7",
      "name": "Enviar_pedido_Saipos",
      "type": "n8n-nodes-base.httpRequest"
    },
    {
      "workflow": "Enviar_pedido",
      "id": "f83c929b-997d-45aa-9782-34445fc5dc80",
      "name": "Salva_pedido_banco",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "Enviar_pedido",
      "id": "e291e237-df8b-439a-b6cf-7c2792321e5e",
      "name": "Wait",
      "type": "n8n-nodes-base.wait"
    },
    {
      "workflow": "Enviar_pedido",
      "id": "4364169f-1680-46b0-8c72-5e73799a9e9d",
      "name": "active_sessions_finished",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "Enviar_pedido",
      "id": "abb0dea4-389c-486b-93f4-e97a3184ff2d",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote"
    },
    {
      "workflow": "Enviar_pedido",
      "id": "901b57b7-33f7-4ff0-9ad5-fa892329b1c8",
      "name": "Search Index",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "Enviar_pedido",
      "id": "7c50fc56-1f4b-45e4-bd50-0818a0e4a5c6",
      "name": "Match Fingerprint",
      "type": "n8n-nodes-base.code"
    },
    {
      "workflow": "Enviar_pedido",
      "id": "fd9921c4-bba0-41ae-8c12-b9ee43479319",
      "name": "Formatar JSON Saipos",
      "type": "n8n-nodes-base.code"
    },
    {
      "workflow": "Gerar Embeddings Card\u00e1pio",
      "id": "6323229a-c2ec-450f-bcb5-c026cc4574af",
      "name": "Supabase - Buscar Itens",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "Gerar Embeddings Card\u00e1pio",
      "id": "dd39f683-68ee-45a3-a459-58c48547b2ff",
      "name": "Supabase - Inserir",
      "type": "n8n-nodes-base.postgres"
    },
    {
      "workflow": "Gerar Embeddings Card\u00e1pio",
      "id": "fde00433-a3f4-4be3-82e4-07c4710dadfd",
      "name": "Loop Over Items1",
      "type": "n8n-nodes-base.splitInBatches"
    },
    {
      "workflow": "Gerar Embeddings Card\u00e1pio",
      "id": "64d25dcc-39fa-444f-83f6-8802df1323ce",
      "name": "When clicking \u2018Execute workflow\u2019",
      "type": "n8n-nodes-base.manualTrigger"
    },
    {
      "workflow": "Gerar Embeddings Card\u00e1pio",
      "id": "544bb0c4-7a17-4334-85b3-106fde0cb2aa",
      "name": "HTTP Request",
      "type": "n8n-nodes-base.httpRequest"
    },
    {
      "workflow": "Gerar Embeddings Card\u00e1pio",
      "id": "07a43228-7109-4636-b22a-6cca4a0fc13c",
      "name": "Code in JavaScript",
      "type": "n8n-nodes-base.code"
    },
    {
      "workflow": "Token_Saipos",
      "id": "daad98bc-6677-4617-b439-77fcfdd0a31b",
      "name": "Token de Autoriza\u00e7\u00e3o",
      "type": "n8n-nodes-base.httpRequest"
    },
    {
      "workflow": "Token_Saipos",
      "id": "72b5ea2e-a0a1-4ad3-9e49-5090067966a3",
      "name": "When clicking \u2018Execute workflow\u2019",
      "type": "n8n-nodes-base.manualTrigger"
    },
    {
      "workflow": "Webhook_Central_Saipos",
      "id": "833758ef-ccca-48c5-b193-01bbeb18b937",
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook"
    },
    {
      "workflow": "Webhook_Central_Saipos",
      "id": "e171ed9c-a76d-42cc-85e7-04d3f1e76d9b",
      "name": "Switch",
      "type": "n8n-nodes-base.switch"
    },
    {
      "workflow": "Webhook_Central_Saipos",
      "id": "bad994c6-d1ad-45c4-936d-1ffe431a862f",
      "name": "M\u00e1rcio Lanches",
      "type": "n8n-nodes-base.httpRequest"
    }
  ],
  "connections": [
    {
      "workflow": "1. Lia_V3.1",
      "source": "Mensagem chegando?",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Tipo de mensagem",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Mensagem recebida",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Info",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Mensagem encavalada?",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Limpar fila de mensagens",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Buscar mensagens",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Mensagem encavalada?",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Concatenar mensagens",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Atendente",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Limpar fila de mensagens",
      "source_output": "main",
      "source_output_index": 0,
      "target": "controle atendimentos",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Esperar",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Buscar mensagens",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Tipo de mensagem",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Enfileirar mensagem.",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Tipo de mensagem",
      "source_output": "main",
      "source_output_index": 1,
      "target": "HTTP Request1",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Tipo de mensagem",
      "source_output": "main",
      "source_output_index": 2,
      "target": "Convert to File",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Tipo de mensagem",
      "source_output": "main",
      "source_output_index": 3,
      "target": "Convert to File2",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Tipo de mensagem",
      "source_output": "main",
      "source_output_index": 5,
      "target": "Convert to File1",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Transcrever \u00e1udio",
      "source_output": "main",
      "source_output_index": 0,
      "target": "controle atendimentos1",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Resetar status",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Responder mensagem \u00e1udio",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Converter \u00e1udio para base64",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Resetar status",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Gerar \u00e1udio",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Converter \u00e1udio para base64",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Formatar SSML",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Gerar \u00e1udio",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Tipo de mensagem1",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Code",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Tipo de mensagem1",
      "source_output": "main",
      "source_output_index": 1,
      "target": "Formatar SSML",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Memory",
      "source_output": "ai_memory",
      "source_output_index": 0,
      "target": "Atendente",
      "target_input": "ai_memory",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Converter base64 para \u00e1udio.",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Transcrever \u00e1udio",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Enfileirar mensagem.",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Esperar",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Google Gemini Chat Model.",
      "source_output": "ai_languageModel",
      "source_output_index": 0,
      "target": "Formatar SSML",
      "target_input": "ai_languageModel",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Info",
      "source_output": "main",
      "source_output_index": 0,
      "target": "historico1",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "cancelar_pedido",
      "source_output": "ai_tool",
      "source_output_index": 0,
      "target": "Atendente",
      "target_input": "ai_tool",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Code",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Loop Over Items",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Loop Over Items",
      "source_output": "main",
      "source_output_index": 1,
      "target": "HTTP Request",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "HTTP Request",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Loop Over Items",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "HTTP Request",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Execution Data",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "HTTP Request1",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Converter base64 para \u00e1udio.",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "HTTP Request1",
      "source_output": "main",
      "source_output_index": 1,
      "target": "HTTP Request2",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "HTTP Request2",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Converter base64 para \u00e1udio.",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Marcar como lida texto",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Concatenar mensagens",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "controle atendimentos",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Marcar como lida texto",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "atualiza atendimento",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Tipo de mensagem1",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Marcar como lida audio",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Concatenar mensagens",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "controle atendimentos1",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Marcar como lida audio",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Convert to File",
      "source_output": "main",
      "source_output_index": 0,
      "target": "OpenAI",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Marcar como lida audio1",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Concatenar mensagens",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "controle atendimentos2",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Marcar como lida audio1",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "OpenAI",
      "source_output": "main",
      "source_output_index": 0,
      "target": "controle atendimentos2",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Atendente",
      "source_output": "main",
      "source_output_index": 0,
      "target": "atualiza atendimento",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "taxa_entrega",
      "source_output": "ai_tool",
      "source_output_index": 0,
      "target": "Atendente",
      "target_input": "ai_tool",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Postgres Chat Memory",
      "source_output": "ai_memory",
      "source_output_index": 0,
      "target": "Chat Memory Manager",
      "target_input": "ai_memory",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "When clicking \u2018Execute workflow\u2019",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Chat Memory Manager",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "OpenAI2",
      "source_output": "ai_languageModel",
      "source_output_index": 0,
      "target": "Atendente",
      "target_input": "ai_languageModel",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Convert to File2",
      "source_output": "main",
      "source_output_index": 0,
      "target": "OpenAI",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "enviar_pedido",
      "source_output": "ai_tool",
      "source_output_index": 0,
      "target": "Atendente",
      "target_input": "ai_tool",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Convert to File1",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Analyze document",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Marcar como lida audio2",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Concatenar mensagens",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "controle atendimentos3",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Marcar como lida audio2",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Analyze document",
      "source_output": "main",
      "source_output_index": 0,
      "target": "controle atendimentos3",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "calcular_totais",
      "source_output": "ai_tool",
      "source_output_index": 0,
      "target": "Atendente",
      "target_input": "ai_tool",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "stages",
      "source_output": "ai_tool",
      "source_output_index": 0,
      "target": "Atendente",
      "target_input": "ai_tool",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "cardapio",
      "source_output": "ai_tool",
      "source_output_index": 0,
      "target": "Atendente",
      "target_input": "ai_tool",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "maps",
      "source_output": "ai_tool",
      "source_output_index": 0,
      "target": "Atendente",
      "target_input": "ai_tool",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "liberado",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Mensagem chegando?",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Filtro de Remetente",
      "source_output": "main",
      "source_output_index": 0,
      "target": "humano assumiu",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "Filtro de Remetente",
      "source_output": "main",
      "source_output_index": 1,
      "target": "liberado",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "1. Lia_V3.1",
      "source": "historico1",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Filtro de Remetente",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "4. Cancelar_pedido",
      "source": "Webhook",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Postgres",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "4. Cancelar_pedido",
      "source": "Postgres",
      "source_output": "main",
      "source_output_index": 0,
      "target": "HTTP Request",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "source": "Webhook",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Verificar Status",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "source": "Verificar Status",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Confirmado",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "source": "Verificar Status",
      "source_output": "main",
      "source_output_index": 1,
      "target": "Aguardando entrega",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "source": "Verificar Status",
      "source_output": "main",
      "source_output_index": 2,
      "target": "Saiu para entrega",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "source": "Verificar Status",
      "source_output": "main",
      "source_output_index": 3,
      "target": "Entregue",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "source": "Verificar Status",
      "source_output": "main",
      "source_output_index": 4,
      "target": "Cancelado",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "source": "Confirmado",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Postgres",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "source": "Aguardando entrega",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Postgres2",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "source": "Saiu para entrega",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Postgres3",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "source": "Entregue",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Postgres4",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "source": "Cancelado",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Postgres1",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "source": "Postgres1",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Enviar mensagem4",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "source": "Postgres",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Enviar mensagem",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "source": "Postgres2",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Enviar mensagem1",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "source": "Postgres3",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Enviar mensagem2",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "source": "Postgres4",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Enviar mensagem3",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "6. Recuperar_pedidos",
      "source": "Schedule Trigger",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Postgres1",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "6. Recuperar_pedidos",
      "source": "Postgres1",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Loop Over Items",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "6. Recuperar_pedidos",
      "source": "Loop Over Items",
      "source_output": "main",
      "source_output_index": 1,
      "target": "Edit Fields",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "6. Recuperar_pedidos",
      "source": "Edit Fields",
      "source_output": "main",
      "source_output_index": 0,
      "target": "AI Agent",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "6. Recuperar_pedidos",
      "source": "Google Gemini Chat Model",
      "source_output": "ai_languageModel",
      "source_output_index": 0,
      "target": "AI Agent",
      "target_input": "ai_languageModel",
      "target_input_index": 0
    },
    {
      "workflow": "6. Recuperar_pedidos",
      "source": "Postgres Chat Memory",
      "source_output": "ai_memory",
      "source_output_index": 0,
      "target": "AI Agent",
      "target_input": "ai_memory",
      "target_input_index": 0
    },
    {
      "workflow": "6. Recuperar_pedidos",
      "source": "AI Agent",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Evolution API",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "6. Recuperar_pedidos",
      "source": "Evolution API",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Postgres",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "7. Valida\u00e7\u00e3o_Endere\u00e7os",
      "source": "Start",
      "source_output": "main",
      "source_output_index": 0,
      "target": "HTTP Request",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "7. Valida\u00e7\u00e3o_Endere\u00e7os",
      "source": "HTTP Request",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Code in JavaScript",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "Atualiza Card\u00e1pio",
      "source": "Schedule Trigger",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Execute a SQL query",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "Atualiza Card\u00e1pio",
      "source": "consulta_cardapio",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Code in JavaScript",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "Atualiza Card\u00e1pio",
      "source": "Code in JavaScript",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Insert rows in a table",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "Atualiza Card\u00e1pio",
      "source": "Execute a SQL query",
      "source_output": "main",
      "source_output_index": 0,
      "target": "consulta_cardapio",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "Enviar_pedido",
      "source": "Webhook",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Search Index",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "Enviar_pedido",
      "source": "Enviar_pedido_Saipos",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Wait",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "Enviar_pedido",
      "source": "Salva_pedido_banco",
      "source_output": "main",
      "source_output_index": 0,
      "target": "active_sessions_finished",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "Enviar_pedido",
      "source": "Wait",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Salva_pedido_banco",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "Enviar_pedido",
      "source": "Search Index",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Match Fingerprint",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "Enviar_pedido",
      "source": "Match Fingerprint",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Formatar JSON Saipos",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "Gerar Embeddings Card\u00e1pio",
      "source": "Supabase - Buscar Itens",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Loop Over Items1",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "Gerar Embeddings Card\u00e1pio",
      "source": "Supabase - Inserir",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Loop Over Items1",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "Gerar Embeddings Card\u00e1pio",
      "source": "Loop Over Items1",
      "source_output": "main",
      "source_output_index": 1,
      "target": "HTTP Request",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "Gerar Embeddings Card\u00e1pio",
      "source": "When clicking \u2018Execute workflow\u2019",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Supabase - Buscar Itens",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "Gerar Embeddings Card\u00e1pio",
      "source": "HTTP Request",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Code in JavaScript",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "Gerar Embeddings Card\u00e1pio",
      "source": "Code in JavaScript",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Supabase - Inserir",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "Token_Saipos",
      "source": "When clicking \u2018Execute workflow\u2019",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Token de Autoriza\u00e7\u00e3o",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "Webhook_Central_Saipos",
      "source": "Webhook",
      "source_output": "main",
      "source_output_index": 0,
      "target": "Switch",
      "target_input": "main",
      "target_input_index": 0
    },
    {
      "workflow": "Webhook_Central_Saipos",
      "source": "Switch",
      "source_output": "main",
      "source_output_index": 0,
      "target": "M\u00e1rcio Lanches",
      "target_input": "main",
      "target_input_index": 0
    }
  ],
  "triggers": [
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "dc69fb75-17b4-4574-9d60-daded7b65374",
      "node_name": "Mensagem recebida",
      "type": "n8n-nodes-base.webhook",
      "http_method": "POST",
      "path": "v3.1"
    },
    {
      "workflow": "4. Cancelar_pedido",
      "node_id": "b33d1e3c-934b-4bd9-9b7a-632312017a13",
      "node_name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "http_method": "POST",
      "path": "cancelar_pedido"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "node_id": "9e119b9d-ca97-480e-a2cb-bd69c9dd29c4",
      "node_name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "http_method": "POST",
      "path": "marcio_lanches"
    },
    {
      "workflow": "Enviar_pedido",
      "node_id": "49a0d126-91c1-43be-89cd-201c7074718a",
      "node_name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "http_method": "POST",
      "path": "enviar-pedido"
    },
    {
      "workflow": "Webhook_Central_Saipos",
      "node_id": "833758ef-ccca-48c5-b193-01bbeb18b937",
      "node_name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "http_method": "POST",
      "path": "saipos-central"
    }
  ],
  "http_requests": [
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "700ef2a7-4535-4798-b20e-adc8b7b77f06",
      "node_name": "Gerar \u00e1udio",
      "method": "POST",
      "url": "https://api.elevenlabs.io/v1/text-to-speech/33B4UnXyTNbgLmdEDh5P",
      "headers": null,
      "body": {
        "parameters": [
          {
            "name": "text",
            "value": "={{ $json.text }}"
          },
          {
            "name": "model_id",
            "value": "eleven_flash_v2_5"
          }
        ]
      }
    },
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "7614af66-47bd-49d6-b03b-a4ae5201a259",
      "node_name": "cancelar_pedido",
      "method": "POST",
      "url": "https://webhook.hub3ps.com/webhook/cancelar_pedido",
      "headers": null,
      "body": {
        "parameters": [
          {
            "name": "telefone",
            "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters0_Value', ``, 'string') }}"
          },
          {
            "name": "order_id",
            "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters1_Value', ``, 'string') }}"
          }
        ]
      }
    },
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "9d3d1c90-f2ee-4380-8b8b-6badc0bb4470",
      "node_name": "HTTP Request",
      "method": "POST",
      "url": "={{ $('Info').item.json.url_evolution }}message/sendText/{{ $('Info').item.json.instancia }}",
      "headers": {
        "apikey": "BE079E70E632-4EE7-8073-A32C924D5057"
      },
      "body": "={\n  \"number\": \"{{ $('Info').item.json.telefone }}\",\n  \"text\": \"{{JSON.stringify($json.mensagem).slice(1,-1)}}\",\n  \"delay\": 4000\n}"
    },
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "1df8c600-732e-40d9-ac4b-2ab1a7321c81",
      "node_name": "HTTP Request1",
      "method": "POST",
      "url": "={{ $json.url_evolution }}/chat/getBase64FromMediaMessage/{{ $json.instancia }}",
      "headers": {
        "apikey": "BE079E70E632-4EE7-8073-A32C924D5057"
      },
      "body": "={\n  \"message\": {\n    \"key\": {\n      \"id\": \"{{ $json.id_mensagem }}\"\n    }\n  },\n  \"convertToMp4\": true\n}"
    },
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "31cdc6e0-4b2c-4700-b7e2-aee3deb384d3",
      "node_name": "HTTP Request2",
      "method": "POST",
      "url": "={{ $json.url_evolution }}/chat/getBase64FromMediaMessage/{{ $json.instancia }}",
      "headers": {
        "apikey": "BE079E70E632-4EE7-8073-A32C924D5057"
      },
      "body": "={\n  \"message\": {\n    \"key\": {\n      \"id\": \"{{ $json.url_audio }}\"\n    }\n  },\n  \"convertToMp4\": true\n}"
    },
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "ef10f770-3ae2-4bde-83f5-9fafd28cd05e",
      "node_name": "enviar_pedido",
      "method": "POST",
      "url": "https://webhook.hub3ps.com/webhook/enviar-pedido",
      "headers": null,
      "body": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('JSON', ``, 'json') }}"
    },
    {
      "workflow": "4. Cancelar_pedido",
      "node_id": "43cf27e3-6f9f-4abc-aecd-d46b0290a7c1",
      "node_name": "HTTP Request",
      "method": "POST",
      "url": "https://order-api.saipos.com/cancel-order",
      "headers": {
        "Authorization": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZFBhcnRuZXIiOiIxYmM0Yzg2NWRlMTk1NDIxMjkxNWJiMGQzMjgzMzI4ZCIsImNyZWF0ZWQiOjE3NTU1NDM0NjE1MTMsImlhdCI6MTc1NTU0MzQ2MSwiZXhwIjoxNzU1NzE2MjYxfQ.tm0t4krNWv-xwsNK-6hnOZWO1PCLUtVp3cmrqwqaf5U",
        "accept": "application/json",
        "content-type": "application/json"
      },
      "body": {
        "parameters": [
          {
            "name": "cod_store",
            "value": "123"
          },
          {
            "name": "order_id",
            "value": "=1755635138128"
          }
        ]
      }
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "node_id": "3c800162-67f1-4f9f-b655-a8f73fe576c8",
      "node_name": "Enviar mensagem",
      "method": "POST",
      "url": "=https://evo.hub3ps.com/message/sendText/Hub3Ps",
      "headers": {
        "apikey": "568E9C603169-47FB-AD18-B59C9D296594"
      },
      "body": "={\n  \"number\": \"55{{ $json.telefone }}\",\n  \"text\": \"Seu pedido foi confirmado com sucesso e j\u00e1 est\u00e1 na fila da cozinha. Em breve ele come\u00e7a a ser preparado!\",\n  \"delay\": 4000\n}"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "node_id": "05c3181a-2456-4315-a975-f45f7e4418fb",
      "node_name": "Enviar mensagem1",
      "method": "POST",
      "url": "=https://evo.hub3ps.com/message/sendText/Hub3Ps",
      "headers": {
        "apikey": "568E9C603169-47FB-AD18-B59C9D296594"
      },
      "body": "={\n  \"number\": \"55{{ $json.telefone }}\",\n  \"text\": \"Boa not\u00edcia, {{ $json.nome }}! \ud83c\udf54 Seu pedido j\u00e1 ficou pronto e agora est\u00e1 aguardando o entregador. Assim que sair, te aviso!\",\n  \"delay\": 4000\n}"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "node_id": "2d4b3451-19c0-4bd8-b7c3-7345c9aff1f8",
      "node_name": "Enviar mensagem2",
      "method": "POST",
      "url": "=https://evo.hub3ps.com/message/sendText/Hub3Ps",
      "headers": {
        "apikey": "568E9C603169-47FB-AD18-B59C9D296594"
      },
      "body": "={\n  \"number\": \"55{{ $json.telefone }}\",\n  \"text\": \"\ud83d\udeb4\u200d\u2642\ufe0f Opa, {{ $json.nome }}! Seu pedido acabou de sair para entrega. Logo logo chega a\u00ed na sua casa, pode ir preparando o apetite! \ud83d\ude0b\",\n  \"delay\": 4000\n}"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "node_id": "0b699df8-cae3-4e1c-bf08-5d351b71b325",
      "node_name": "Enviar mensagem3",
      "method": "POST",
      "url": "=https://evo.hub3ps.com/message/sendText/Hub3Ps",
      "headers": {
        "apikey": "568E9C603169-47FB-AD18-B59C9D296594"
      },
      "body": "={\n  \"number\": \"55{{ $json.telefone }}\",\n  \"text\": \"{{ $json.nome }}, acabamos de confirmar que seu pedido foi entregue \u2705. Esperamos que voc\u00ea aproveite muito a refei\u00e7\u00e3o! Obrigado por pedir com a gente. \ud83d\udc9b\",\n  \"delay\": 4000\n}"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "node_id": "1b45b778-b4d4-4c91-8653-fc6d2ed2ab55",
      "node_name": "Enviar mensagem4",
      "method": "POST",
      "url": "=https://evo.hub3ps.com/message/sendText/Hub3Ps",
      "headers": {
        "apikey": "568E9C603169-47FB-AD18-B59C9D296594"
      },
      "body": "={\n  \"number\": \"55{{ $json.telefone }}\",\n  \"text\": \"{{ $json.nome }}. \ud83d\ude14 Seu pedido foi cancelado. Se quiser, pode falar com a gente aqui para entendermos melhor ou fazer um novo pedido a qualquer momento. Estamos \u00e0 disposi\u00e7\u00e3o!\",\n  \"delay\": 4000\n}"
    },
    {
      "workflow": "7. Valida\u00e7\u00e3o_Endere\u00e7os",
      "node_id": "839cd279-5ac3-443a-88cb-d416b31d1a4a",
      "node_name": "HTTP Request",
      "method": null,
      "url": "https://maps.googleapis.com/maps/api/geocode/json",
      "headers": null,
      "body": null
    },
    {
      "workflow": "Atualiza Card\u00e1pio",
      "node_id": "54314f11-93e9-435a-b99b-fe53480ffb2c",
      "node_name": "consulta_cardapio",
      "method": null,
      "url": "https://order-api.saipos.com/catalog",
      "headers": {
        "Authorization": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZFBhcnRuZXIiOiI0NzJkMjZhYzU0OGIwZTk3YjdjM2E0ZGZhYTMxZjlhNSIsImNyZWF0ZWQiOjE3NjU5MDc5NjQ0NDksImlhdCI6MTc2NTkwNzk2NCwiZXhwIjoxNzY2MDgwNzY0fQ.mtyuz9t_vbgXce19Ai3T7A8_wLONdEgS4A9oDeKx0fU",
        "accept": "application/json"
      },
      "body": null
    },
    {
      "workflow": "Enviar_pedido",
      "node_id": "5781eed6-c595-449f-a637-cb48214601d7",
      "node_name": "Enviar_pedido_Saipos",
      "method": "POST",
      "url": "https://order-api.saipos.com/order",
      "headers": {
        "content-type": "application/json",
        "Authorization": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZFBhcnRuZXIiOiI0NzJkMjZhYzU0OGIwZTk3YjdjM2E0ZGZhYTMxZjlhNSIsImNyZWF0ZWQiOjE3NjA5ODExNjgwMjgsImlhdCI6MTc2MDk4MTE2OCwiZXhwIjoxNzYxMTUzOTY4fQ.kPX7ooLGesv1YP6qLzHdAkqC_TPlhDh5AdEpEe3mkco",
        "accept": "application/json"
      },
      "body": "={{ $json }}"
    },
    {
      "workflow": "Gerar Embeddings Card\u00e1pio",
      "node_id": "544bb0c4-7a17-4334-85b3-106fde0cb2aa",
      "node_name": "HTTP Request",
      "method": "POST",
      "url": "https://api.openai.com/v1/embeddings",
      "headers": null,
      "body": "={\n  \"model\": \"text-embedding-3-small\",\n  \"input\": \"={{ $json.display_name }}\"\n}"
    },
    {
      "workflow": "Token_Saipos",
      "node_id": "daad98bc-6677-4617-b439-77fcfdd0a31b",
      "node_name": "Token de Autoriza\u00e7\u00e3o",
      "method": "POST",
      "url": "https://order-api.saipos.com/auth",
      "headers": {
        "Content-Type": "application/json",
        "Accept": "application/json"
      },
      "body": "={\n  \"idPartner\": \"472d26ac548b0e97b7c3a4dfaa31f9a5\",\n  \"secret\": \"b7e1ceaa4d3637b0e4b20df9ef792e3d\"\n}"
    },
    {
      "workflow": "Webhook_Central_Saipos",
      "node_id": "bad994c6-d1ad-45c4-936d-1ffe431a862f",
      "node_name": "M\u00e1rcio Lanches",
      "method": "POST",
      "url": "https://webhook.hub3ps.com/webhook/marcio_lanches",
      "headers": null,
      "body": "={{ $json.body }}"
    }
  ],
  "postgres_queries": [
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "f5bb5b9c-0109-4906-9367-48df87c660d9",
      "node_name": "Buscar mensagens",
      "operation": "select",
      "schema": "public",
      "table": "n8n_fila_mensagens",
      "query": null,
      "where": {
        "values": [
          {
            "column": "telefone",
            "value": "={{ $json.telefone }}"
          },
          {
            "column": "status",
            "value": "={{ $json.status }}"
          }
        ]
      }
    },
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "a51493d4-efb0-4ba2-ae4c-606163a40c2f",
      "node_name": "Limpar fila de mensagens",
      "operation": "deleteTable",
      "schema": "public",
      "table": "n8n_fila_mensagens",
      "query": null,
      "where": {
        "values": [
          {
            "column": "telefone",
            "value": "={{$json.telefone}}"
          }
        ]
      }
    },
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "f2b4fa71-067e-41df-9241-0585f654e9bf",
      "node_name": "Memory",
      "operation": null,
      "schema": null,
      "table": null,
      "query": null
    },
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "30db27c0-35c3-4e26-882a-14fc0a5f4828",
      "node_name": "Enfileirar mensagem.",
      "operation": null,
      "schema": "public",
      "table": "n8n_fila_mensagens",
      "query": null,
      "columns": {
        "mappingMode": "defineBelow",
        "value": {
          "telefone": "={{ $('Info').item.json.telefone }}",
          "mensagem": "={{ $('Info').item.json.mensagem }}",
          "timestamp": "={{ $('Info').item.json.timestamp.toDateTime('s') }}",
          "id_mensagem": "={{ $('Info').item.json.id_mensagem }}",
          "client_id": "={{ \"06a81600-26fc-472b-880e-e6293943354e\" }}",
          "trace_id": "={{ $json.trace_id }}",
          "message_id": "={{ $json.id_mensagem }}",
          "remote_jid": "={{ $json.remote_jid }}",
          "message_type": "={{ $json.message_type }}",
          "status": "={{ \"pending\" }}"
        },
        "matchingColumns": [
          "id"
        ],
        "schema": [
          {
            "id": "id",
            "displayName": "id",
            "required": false,
            "defaultMatch": true,
            "display": true,
            "type": "number",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "id_mensagem",
            "displayName": "id_mensagem",
            "required": true,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": false
          },
          {
            "id": "telefone",
            "displayName": "telefone",
            "required": true,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true
          },
          {
            "id": "mensagem",
            "displayName": "mensagem",
            "required": true,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true
          },
          {
            "id": "timestamp",
            "displayName": "timestamp",
            "required": true,
            "defaultMatch": false,
            "display": true,
            "type": "dateTime",
            "canBeUsedToMatch": true
          },
          {
            "id": "client_id",
            "displayName": "client_id",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": false
          },
          {
            "id": "trace_id",
            "displayName": "trace_id",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": false
          },
          {
            "id": "message_id",
            "displayName": "message_id",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": false
          },
          {
            "id": "remote_jid",
            "displayName": "remote_jid",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": false
          },
          {
            "id": "message_type",
            "displayName": "message_type",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": false
          },
          {
            "id": "status",
            "displayName": "status",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": false
          },
          {
            "id": "locked_at",
            "displayName": "locked_at",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "dateTime",
            "canBeUsedToMatch": true,
            "removed": false
          },
          {
            "id": "locked_by",
            "displayName": "locked_by",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": false
          },
          {
            "id": "processed_at",
            "displayName": "processed_at",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "dateTime",
            "canBeUsedToMatch": true,
            "removed": false
          },
          {
            "id": "error",
            "displayName": "error",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": false
          }
        ],
        "attemptToConvertTypes": false,
        "convertFieldsToString": false
      }
    },
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "b3638eae-e47e-4dfe-94d0-3c8b577cb64d",
      "node_name": "controle atendimentos",
      "operation": "executeQuery",
      "schema": null,
      "table": null,
      "query": "INSERT INTO public.active_sessions AS s\n  (session_id, last_message, last_message_type, status)\nVALUES\n  (\n    '{{ $(\"Info\").first().json.telefone || $json.session_id }}',   -- fone (sem +)\n    '{{ $(\"Mensagem encavalada?\").all().map(i => i.json.mensagem).join(\"\\\\n\") }}',  -- texto puro\n    'human',\n    'active'\n  )\nON CONFLICT (session_id) WHERE (status = 'active')\nDO UPDATE\n   SET last_message      = EXCLUDED.last_message,\n       last_message_type = 'human',\n       updated_at        = now(),\n       followup_sent_at  = NULL;  -- reseta quando o humano responde"
    },
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "9e09756c-5e31-4387-8665-39bdd0d913c2",
      "node_name": "atualiza atendimento",
      "operation": "executeQuery",
      "schema": null,
      "table": null,
      "query": "INSERT INTO public.active_sessions\n  (session_id, last_message, last_message_type, status)\nVALUES\n  (\n    '{{ $(\"Info\").first().json.telefone || $json.session_id }}',\n    '{{ String($json.output || $json.text || $json.reply || \"\").replace(/'/g,\"''\") }}',\n    'ai',\n    'active'\n  )\nON CONFLICT (session_id) WHERE (status = 'active')\nDO UPDATE\n   SET last_message      = EXCLUDED.last_message,\n       last_message_type = 'ai',\n       updated_at        = now();\n"
    },
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "85fbcfb1-8427-4482-a34f-d56164231287",
      "node_name": "controle atendimentos1",
      "operation": "executeQuery",
      "schema": null,
      "table": null,
      "query": "INSERT INTO public.active_sessions AS s\n  (session_id, last_message, last_message_type, status)\nVALUES\n  (\n    '{{ $('Info').item.json.telefone || $json.session_id }}',   -- fone (sem +)\n    '{{ $json.text }}',                       -- texto puro\n    'human',\n    'active'\n  )\nON CONFLICT (session_id) WHERE (status = 'active')\nDO UPDATE\n   SET last_message      = EXCLUDED.last_message,\n       last_message_type = 'human',\n       updated_at        = now(),\n       followup_sent_at  = NULL;  -- reseta quando o humano responde"
    },
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "ba5e58a4-adae-4005-9b03-586f59cd601c",
      "node_name": "controle atendimentos2",
      "operation": "executeQuery",
      "schema": null,
      "table": null,
      "query": "INSERT INTO public.active_sessions AS s\n  (session_id, last_message, last_message_type, status)\nVALUES\n  (\n    '{{ $('Info').item.json.telefone || $json.session_id }}',   -- fone (sem +)\n    '{{ $json.content }}',                       -- texto puro\n    'human',\n    'active'\n  )\nON CONFLICT (session_id) WHERE (status = 'active')\nDO UPDATE\n   SET last_message      = EXCLUDED.last_message,\n       last_message_type = 'human',\n       updated_at        = now(),\n       followup_sent_at  = NULL;  -- reseta quando o humano responde"
    },
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "bff1176e-4b56-4ed1-9898-4df7de5d56a0",
      "node_name": "taxa_entrega",
      "operation": "executeQuery",
      "schema": null,
      "table": null,
      "query": "SELECT \n  district AS bairro,\n  delivery_fee AS taxa_entrega,\n  city AS cidade\nFROM delivery_areas\nWHERE active = true\n  AND unaccent(LOWER(city)) = unaccent(LOWER('Itaja\u00ed'))\n  AND (\n    unaccent(LOWER(district)) = unaccent(LOWER($1))\n    OR unaccent(LOWER(district)) LIKE '%' || unaccent(LOWER($1)) || '%'\n  )\nORDER BY \n  CASE \n    WHEN unaccent(LOWER(district)) = unaccent(LOWER($1)) THEN 0 \n    ELSE 1 \n  END,\n  district\nLIMIT 10;"
    },
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "2aef5b99-c5a8-483f-854f-dbcbb26d6529",
      "node_name": "Postgres Chat Memory",
      "operation": null,
      "schema": null,
      "table": null,
      "query": null
    },
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "d0d2155e-1872-497f-83a6-35d4a28d0800",
      "node_name": "controle atendimentos3",
      "operation": "executeQuery",
      "schema": null,
      "table": null,
      "query": "INSERT INTO public.active_sessions AS s\n  (session_id, last_message, last_message_type, status)\nVALUES\n  (\n    '{{ $('Info').item.json.telefone || $json.session_id }}',   -- fone (sem +)\n    '{{ $json.content }}',                       -- texto puro\n    'human',\n    'active'\n  )\nON CONFLICT (session_id) WHERE (status = 'active')\nDO UPDATE\n   SET last_message      = EXCLUDED.last_message,\n       last_message_type = 'human',\n       updated_at        = now(),\n       followup_sent_at  = NULL;  -- reseta quando o humano responde"
    },
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "73651afc-3948-484e-b463-34573ef27296",
      "node_name": "stages",
      "operation": "executeQuery",
      "schema": null,
      "table": null,
      "query": "SELECT\n  stage,\n  rules\nFROM public.delivery_policies_v2\nWHERE\n  client_id = '06a81600-26fc-472b-880e-e6293943354e'::uuid\n  AND stage = $1\n  AND is_active = true\nLIMIT 1;"
    },
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "2459e30e-3c76-4a5b-bd0d-b71997a91b08",
      "node_name": "cardapio",
      "operation": "executeQuery",
      "schema": null,
      "table": null,
      "query": "SELECT\n  categoria,\n  item,\n  tamanho,\n  tipo,\n  price,\n  adicionais\nFROM public.menu_catalog_agent_v1\nWHERE client_id = '06a81600-26fc-472b-880e-e6293943354e'::uuid;"
    },
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "695d18fd-e05f-486c-bd18-e4a2b72ee1e3",
      "node_name": "liberado",
      "operation": "executeQuery",
      "schema": null,
      "table": null,
      "query": "SELECT 1\nWHERE NOT EXISTS (\n  SELECT 1\n  FROM public.active_sessions\n  WHERE session_id = '{{ $json.telefone }}'\n    AND last_message_type <> 'ai'\n);"
    },
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "4ef66efc-6856-4ffe-9369-e51fc2c726b2",
      "node_name": "humano assumiu",
      "operation": "executeQuery",
      "schema": null,
      "table": null,
      "query": "INSERT INTO public.active_sessions\n  (session_id, last_message, last_message_type, status)\nVALUES\n  (\n    '{{ $(\"Info\").first().json.telefone || $json.session_id }}',\n    '{{ String($json.output || $json.text || $json.reply || \"\").replace(/'/g,\"''\") }}',\n    'human',\n    'active'\n  )\nON CONFLICT (session_id) WHERE (status = 'active')\nDO UPDATE\n   SET last_message      = EXCLUDED.last_message,\n       last_message_type = 'human',\n       updated_at        = now();\n"
    },
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "a37af949-52e3-4e52-9a13-93781355bdf5",
      "node_name": "historico1",
      "operation": "executeQuery",
      "schema": null,
      "table": null,
      "query": "WITH inp AS (\n  SELECT regexp_replace($1::text, '\\D', '', 'g') AS d\n),\ncand AS (\n  -- d (como veio), d sem 55 e d com 55\n  SELECT d                            AS k FROM inp\n  UNION ALL SELECT CASE WHEN left(d,2)='55' THEN substring(d from 3) ELSE d END FROM inp\n  UNION ALL SELECT CASE WHEN left(d,2)='55' THEN d ELSE '55'||d END FROM inp\n)\nSELECT *\nFROM public.view_client_snapshot\nWHERE regexp_replace(phone, '\\D', '', 'g') IN (SELECT k FROM cand)\nORDER BY last_order_at DESC NULLS LAST\nLIMIT 1;"
    },
    {
      "workflow": "4. Cancelar_pedido",
      "node_id": "b0e779e2-f9bb-4136-ba17-74b5b8309f8d",
      "node_name": "Postgres",
      "operation": "select",
      "schema": "public",
      "table": "orders",
      "query": null,
      "where": {
        "values": [
          {
            "column": "order_id",
            "value": "={{ $json.body.order_id }}"
          }
        ]
      }
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "node_id": "3c1098ac-9082-4473-92df-2c0589218a69",
      "node_name": "Confirmado",
      "operation": "update",
      "schema": "public",
      "table": "orders",
      "query": null,
      "columns": {
        "mappingMode": "defineBelow",
        "value": {
          "status": "CONFIRMED",
          "order_id": "={{ $json.body.order_id }}"
        },
        "matchingColumns": [
          "order_id"
        ],
        "schema": [
          {
            "id": "id",
            "displayName": "id",
            "required": false,
            "defaultMatch": true,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "order_id",
            "displayName": "order_id",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": false
          },
          {
            "id": "nome",
            "displayName": "nome",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "telefone",
            "displayName": "telefone",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "endereco",
            "displayName": "endereco",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "pedido",
            "displayName": "pedido",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "observacoes",
            "displayName": "observacoes",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "pagamento",
            "displayName": "pagamento",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "total",
            "displayName": "total",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "created_at",
            "displayName": "created_at",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "dateTime",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "status",
            "displayName": "status",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true
          }
        ],
        "attemptToConvertTypes": false,
        "convertFieldsToString": false
      }
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "node_id": "7d1d26e5-a15f-439a-889d-8ed44a17576a",
      "node_name": "Aguardando entrega",
      "operation": "update",
      "schema": "public",
      "table": "orders",
      "query": null,
      "columns": {
        "mappingMode": "defineBelow",
        "value": {
          "status": "READY_TO_DELIVER",
          "order_id": "={{ $json.body.order_id }}"
        },
        "matchingColumns": [
          "order_id"
        ],
        "schema": [
          {
            "id": "id",
            "displayName": "id",
            "required": false,
            "defaultMatch": true,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "order_id",
            "displayName": "order_id",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": false
          },
          {
            "id": "nome",
            "displayName": "nome",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "telefone",
            "displayName": "telefone",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "endereco",
            "displayName": "endereco",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "pedido",
            "displayName": "pedido",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "observacoes",
            "displayName": "observacoes",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "pagamento",
            "displayName": "pagamento",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "total",
            "displayName": "total",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "created_at",
            "displayName": "created_at",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "dateTime",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "status",
            "displayName": "status",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true
          }
        ],
        "attemptToConvertTypes": false,
        "convertFieldsToString": false
      }
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "node_id": "13c43016-22ef-44ec-a482-2d92ac73b2d6",
      "node_name": "Saiu para entrega",
      "operation": "update",
      "schema": "public",
      "table": "orders",
      "query": null,
      "columns": {
        "mappingMode": "defineBelow",
        "value": {
          "status": "DISPATCHED",
          "order_id": "={{ $json.body.order_id }}"
        },
        "matchingColumns": [
          "order_id"
        ],
        "schema": [
          {
            "id": "id",
            "displayName": "id",
            "required": false,
            "defaultMatch": true,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "order_id",
            "displayName": "order_id",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": false
          },
          {
            "id": "nome",
            "displayName": "nome",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "telefone",
            "displayName": "telefone",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "endereco",
            "displayName": "endereco",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "pedido",
            "displayName": "pedido",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "observacoes",
            "displayName": "observacoes",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "pagamento",
            "displayName": "pagamento",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "total",
            "displayName": "total",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "created_at",
            "displayName": "created_at",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "dateTime",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "status",
            "displayName": "status",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true
          }
        ],
        "attemptToConvertTypes": false,
        "convertFieldsToString": false
      }
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "node_id": "bb603380-026f-4aac-ba8c-6d4a11ed78ef",
      "node_name": "Entregue",
      "operation": "update",
      "schema": "public",
      "table": "orders",
      "query": null,
      "columns": {
        "mappingMode": "defineBelow",
        "value": {
          "status": "CONCLUDED",
          "order_id": "={{ $json.body.order_id }}"
        },
        "matchingColumns": [
          "order_id"
        ],
        "schema": [
          {
            "id": "id",
            "displayName": "id",
            "required": false,
            "defaultMatch": true,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "order_id",
            "displayName": "order_id",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": false
          },
          {
            "id": "nome",
            "displayName": "nome",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "telefone",
            "displayName": "telefone",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "endereco",
            "displayName": "endereco",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "pedido",
            "displayName": "pedido",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "observacoes",
            "displayName": "observacoes",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "pagamento",
            "displayName": "pagamento",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "total",
            "displayName": "total",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "created_at",
            "displayName": "created_at",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "dateTime",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "status",
            "displayName": "status",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true
          }
        ],
        "attemptToConvertTypes": false,
        "convertFieldsToString": false
      }
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "node_id": "803ca9bd-1404-499e-b7d9-091c35b19f4f",
      "node_name": "Cancelado",
      "operation": "update",
      "schema": "public",
      "table": "orders",
      "query": null,
      "columns": {
        "mappingMode": "defineBelow",
        "value": {
          "status": "CANCELLED",
          "order_id": "={{ $json.body.order_id }}"
        },
        "matchingColumns": [
          "order_id"
        ],
        "schema": [
          {
            "id": "id",
            "displayName": "id",
            "required": false,
            "defaultMatch": true,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "order_id",
            "displayName": "order_id",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": false
          },
          {
            "id": "nome",
            "displayName": "nome",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "telefone",
            "displayName": "telefone",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "endereco",
            "displayName": "endereco",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "pedido",
            "displayName": "pedido",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "observacoes",
            "displayName": "observacoes",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "pagamento",
            "displayName": "pagamento",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "total",
            "displayName": "total",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "created_at",
            "displayName": "created_at",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "dateTime",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "status",
            "displayName": "status",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true
          }
        ],
        "attemptToConvertTypes": false,
        "convertFieldsToString": false
      }
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "node_id": "b1bb18d3-e418-47ad-81ec-b02d8ad55407",
      "node_name": "Postgres",
      "operation": "select",
      "schema": "public",
      "table": "orders",
      "query": null,
      "where": {
        "values": [
          {
            "column": "order_id",
            "value": "={{ $json.order_id }}"
          }
        ]
      }
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "node_id": "8e021fef-74ae-49c1-9213-27e37ddabd33",
      "node_name": "Postgres1",
      "operation": "select",
      "schema": "public",
      "table": "orders",
      "query": null,
      "where": {
        "values": [
          {
            "column": "order_id",
            "value": "={{ $json.order_id }}"
          }
        ]
      }
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "node_id": "c05a595b-2661-4142-87b6-8662d035bf3f",
      "node_name": "Postgres2",
      "operation": "select",
      "schema": "public",
      "table": "orders",
      "query": null,
      "where": {
        "values": [
          {
            "column": "order_id",
            "value": "={{ $json.order_id }}"
          }
        ]
      }
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "node_id": "e089fe34-461d-443e-8f95-80d1b2da4a48",
      "node_name": "Postgres3",
      "operation": "select",
      "schema": "public",
      "table": "orders",
      "query": null,
      "where": {
        "values": [
          {
            "column": "order_id",
            "value": "={{ $json.order_id }}"
          }
        ]
      }
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "node_id": "2ff69857-e567-476e-b398-5c9a5e75fdf1",
      "node_name": "Postgres4",
      "operation": "select",
      "schema": "public",
      "table": "orders",
      "query": null,
      "where": {
        "values": [
          {
            "column": "order_id",
            "value": "={{ $json.order_id }}"
          }
        ]
      }
    },
    {
      "workflow": "6. Recuperar_pedidos",
      "node_id": "5b2f7976-c8fd-4107-bd08-0704998ebcfc",
      "node_name": "Postgres1",
      "operation": "executeQuery",
      "schema": null,
      "table": null,
      "query": "SELECT id, session_id, last_message, last_message_type, updated_at, followup_count\nFROM public.active_sessions\nWHERE status = 'active'\n  AND last_message_type IN ('ai','human')\n  AND updated_at < now() - interval '10 minutes'\n  AND COALESCE(followup_count,0) < 2      -- \u2705 at\u00e9 2-1 tentativas\n  AND followup_sent_at IS NULL            -- \u2705 ainda n\u00e3o retomado neste ciclo\nORDER BY updated_at ASC\nLIMIT 200;"
    },
    {
      "workflow": "6. Recuperar_pedidos",
      "node_id": "6eb6f9f2-81c5-4354-86e0-d91aa74e5310",
      "node_name": "Postgres Chat Memory",
      "operation": null,
      "schema": null,
      "table": null,
      "query": null
    },
    {
      "workflow": "6. Recuperar_pedidos",
      "node_id": "cda4a656-afa6-46a0-be8a-a937c19696d8",
      "node_name": "Postgres",
      "operation": "executeQuery",
      "schema": null,
      "table": null,
      "query": "UPDATE public.active_sessions\nSET\n  last_message       = '{{ String($json.mensagem ?? $json.reply ?? $json.text ?? $json.data?.message?.conversation ?? \"\").replace(/'/g,\"''\") }}',\n  last_message_type  = 'ai',\n  updated_at         = NOW(),\n  followup_sent_at   = NOW(),\n  followup_count     = COALESCE(followup_count, 0) + 1\nWHERE session_id = '{{ $('Edit Fields').item.json.telefone ?? $json.session_id }}'\n  AND status = 'active';"
    },
    {
      "workflow": "Atualiza Card\u00e1pio",
      "node_id": "ce20c0b0-c35a-45cb-95e8-e48a3d797dda",
      "node_name": "Execute a SQL query",
      "operation": "executeQuery",
      "schema": null,
      "table": null,
      "query": "DELETE FROM public.saipos_menu_raw\nWHERE client_id = '06a81600-26fc-472b-880e-e6293943354e'::uuid;"
    },
    {
      "workflow": "Atualiza Card\u00e1pio",
      "node_id": "0e3eb3f8-9881-412f-9471-362ff3d7178e",
      "node_name": "Insert rows in a table",
      "operation": null,
      "schema": "public",
      "table": "saipos_menu_raw",
      "query": null,
      "columns": {
        "mappingMode": "defineBelow",
        "value": {
          "client_id": "={{ $json.client_id }}",
          "tipo": "={{ $json.tipo }}",
          "categoria": "={{ $json.categoria }}",
          "tamanho": "={{ $json.tamanho }}",
          "id_store_item": "={{ $json.id_store_item }}",
          "item": "={{ $json.item }}",
          "id_store_choice": "={{ $json.id_store_choice }}",
          "complemento": "={{ $json.complemento }}",
          "complemento_item": "={{ $json.complemento_item }}",
          "price": "={{ $json.price }}",
          "codigo_saipos": "={{ $json.codigo_saipos }}",
          "store_item_enabled": "={{ $json.store_item_enabled }}",
          "store_choice_enabled": "={{ $json.store_choice_enabled }}",
          "store_choice_item_enabled": "={{ $json.store_choice_item_enabled }}",
          "item_type": "={{ $json.item_type }}",
          "pdv_code": "={{ $json.pdv_code }}",
          "parent_pdv_code": "={{ $json.parent_pdv_code }}",
          "created_at": "2025-12-16T18:08:17"
        },
        "matchingColumns": [
          "id"
        ],
        "schema": [
          {
            "id": "id",
            "displayName": "id",
            "required": false,
            "defaultMatch": true,
            "display": true,
            "type": "number",
            "canBeUsedToMatch": true,
            "removed": true
          },
          {
            "id": "client_id",
            "displayName": "client_id",
            "required": true,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true
          },
          {
            "id": "tipo",
            "displayName": "tipo",
            "required": true,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true
          },
          {
            "id": "categoria",
            "displayName": "categoria",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true
          },
          {
            "id": "tamanho",
            "displayName": "tamanho",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true
          },
          {
            "id": "id_store_item",
            "displayName": "id_store_item",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "number",
            "canBeUsedToMatch": true
          },
          {
            "id": "item",
            "displayName": "item",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true
          },
          {
            "id": "id_store_choice",
            "displayName": "id_store_choice",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "number",
            "canBeUsedToMatch": true
          },
          {
            "id": "complemento",
            "displayName": "complemento",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true
          },
          {
            "id": "complemento_item",
            "displayName": "complemento_item",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true
          },
          {
            "id": "price",
            "displayName": "price",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "number",
            "canBeUsedToMatch": true
          },
          {
            "id": "codigo_saipos",
            "displayName": "codigo_saipos",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true
          },
          {
            "id": "store_item_enabled",
            "displayName": "store_item_enabled",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true
          },
          {
            "id": "store_choice_enabled",
            "displayName": "store_choice_enabled",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true
          },
          {
            "id": "store_choice_item_enabled",
            "displayName": "store_choice_item_enabled",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true
          },
          {
            "id": "item_type",
            "displayName": "item_type",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true
          },
          {
            "id": "pdv_code",
            "displayName": "pdv_code",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true
          },
          {
            "id": "parent_pdv_code",
            "displayName": "parent_pdv_code",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "string",
            "canBeUsedToMatch": true
          },
          {
            "id": "created_at",
            "displayName": "created_at",
            "required": false,
            "defaultMatch": false,
            "display": true,
            "type": "dateTime",
            "canBeUsedToMatch": true
          }
        ],
        "attemptToConvertTypes": false,
        "convertFieldsToString": false
      }
    },
    {
      "workflow": "Enviar_pedido",
      "node_id": "f83c929b-997d-45aa-9782-34445fc5dc80",
      "node_name": "Salva_pedido_banco",
      "operation": "executeQuery",
      "schema": null,
      "table": null,
      "query": "SELECT public.upsert_delivery_batch('{{ JSON.stringify([$json]) }}'::jsonb);"
    },
    {
      "workflow": "Enviar_pedido",
      "node_id": "4364169f-1680-46b0-8c72-5e73799a9e9d",
      "node_name": "active_sessions_finished",
      "operation": "executeQuery",
      "schema": null,
      "table": null,
      "query": "UPDATE public.active_sessions\nSET \n  status = 'finished',\n  updated_at = NOW()\nWHERE session_id = '{{ $json.customer.id || $json.session_id }}'\n  AND status = 'active';\n"
    },
    {
      "workflow": "Enviar_pedido",
      "node_id": "901b57b7-33f7-4ff0-9ad5-fa892329b1c8",
      "node_name": "Search Index",
      "operation": "executeQuery",
      "schema": null,
      "table": null,
      "query": "SELECT * FROM v_menu_search_index;"
    },
    {
      "workflow": "Gerar Embeddings Card\u00e1pio",
      "node_id": "6323229a-c2ec-450f-bcb5-c026cc4574af",
      "node_name": "Supabase - Buscar Itens",
      "operation": "executeQuery",
      "schema": null,
      "table": null,
      "query": "-- Buscar itens\nSELECT \n    item_id::text,\n    pdv,\n    display_name,\n    category,\n    price::numeric\nFROM v_menu_catalog \nWHERE active = true\nORDER BY category, display_name;"
    },
    {
      "workflow": "Gerar Embeddings Card\u00e1pio",
      "node_id": "dd39f683-68ee-45a3-a459-58c48547b2ff",
      "node_name": "Supabase - Inserir",
      "operation": "executeQuery",
      "schema": null,
      "table": null,
      "query": "{{ $json.query }}"
    }
  ],
  "code_nodes": [
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "8fa19d54-ae6f-40d4-bcc2-549a1d157b65",
      "node_name": "Mensagem encavalada?",
      "language": "javascript",
      "snippet": "const ultima_mensagem_da_fila = $input.last()\nconst mensagem_do_workflow = $('Info').first()\n\nif (ultima_mensagem_da_fila.json.id_mensagem !== mensagem_do_workflow.json.id_mensagem) {\n  // Mensagem encavalada, para o workflow\n  return [];\n}\n\n// Pass-through da fila de mensagens\nreturn $input.all();"
    },
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "4e62e363-6d65-4f98-a59b-b602b5c5725e",
      "node_name": "Code",
      "language": "javascript",
      "snippet": "// Prioriza o texto do node \"Atendente\"\nconst fromAttNode =\n  ($node[\"Atendente\"]?.json?.output) ??\n  ($items(\"Atendente\")?.[0]?.json?.output);\n\n// Demais fontes (fallbacks)\nconst raw =\n  fromAttNode ??\n  $json?.message?.content ??\n  $json?.output ??\n  $json?.mensagem ??\n  $json?.text ??\n  $json?.te\u2026"
    },
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "320dcae4-754d-4b0b-b160-b464759054ac",
      "node_name": "calcular_totais",
      "language": "javascript",
      "snippet": "// Tool \"calcular_totais\" para o AI Agent do n8n\n\nlet data = query ?? {};\n\n// --- LIMPEZA E PARSE DO INPUT ---\nif (typeof data === 'string') {\n  try {\n    // 1. Remove formata\u00e7\u00e3o de c\u00f3digo markdown (```json e ```)\n    let cleanData = data.replace(/```json/gi, '').replace(/```/g, '').trim();\n\n    // \u2026"
    },
    {
      "workflow": "7. Valida\u00e7\u00e3o_Endere\u00e7os",
      "node_id": "9c1e6dd8-5afa-41f6-a95a-ccbe37a1f891",
      "node_name": "Code in JavaScript",
      "language": "javascript",
      "snippet": "const components = $input.first().json.results[0].address_components;\n\nconst findByType = (types) => {\n  const item = components.find(c => types.some(t => c.types.includes(t)));\n  return item?.long_name || null;\n};\n\nreturn {\n  json: {\n    rua: findByType(['route']),\n    numero: findByType(['street_n\u2026"
    },
    {
      "workflow": "Atualiza Card\u00e1pio",
      "node_id": "8d7ffbef-c426-40bd-8b97-3f9b55a8a2f0",
      "node_name": "Code in JavaScript",
      "language": "javascript",
      "snippet": "const CLIENT_ID = '06a81600-26fc-472b-880e-e6293943354e';\n\nconst items = $input.all(); // pega todos os itens do HTTP Request\n\nconst result = [];\n\nfor (const item of items) {\n  const row = item.json; // linha original da Saipos\n\n  const codigo = row.codigo_saipos || null;\n\n  // pdv_code = c\u00f3digo com\u2026"
    },
    {
      "workflow": "Enviar_pedido",
      "node_id": "7c50fc56-1f4b-45e4-bd50-0818a0e4a5c6",
      "node_name": "Match Fingerprint",
      "language": "javascript",
      "snippet": "// ============================================================\n// 1. PREPARA\u00c7\u00c3O DOS DADOS\n// ============================================================\n\n// Recebe o pedido do n\u00f3 Webhook\nconst pedidoOriginal = $('Webhook').first().json.body; \n\n// Recebe o \u00edndice de busca do banco\nconst indiceBanco\u2026"
    },
    {
      "workflow": "Enviar_pedido",
      "node_id": "fd9921c4-bba0-41ae-8c12-b9ee43479319",
      "node_name": "Formatar JSON Saipos",
      "language": "javascript",
      "snippet": "// ========== DEBUG: Visualizar estrutura do input ==========\n// Descomente as linhas abaixo para ver o que est\u00e1 chegando\n// console.log(\"items completo:\", JSON.stringify(items, null, 2));\n// console.log(\"items[0]:\", JSON.stringify(items[0], null, 2));\n\n// Pega o JSON que vem do agente de IA\n// Test\u2026"
    },
    {
      "workflow": "Gerar Embeddings Card\u00e1pio",
      "node_id": "07a43228-7109-4636-b22a-6cca4a0fc13c",
      "node_name": "Code in JavaScript",
      "language": "javascript",
      "snippet": "const item = $('Loop Over Items1').item.json;\nconst embedding = $json.data[0].embedding;\n\nconst escapeSql = (str) => str.replace(/'/g, \"''\");\n\nconst query = `\nINSERT INTO menu_embeddings \n(pdv, display_name, category, price, embedding)\nVALUES \n(\n  '${escapeSql(item.pdv)}',\n  '${escapeSql(item.displa\u2026"
    }
  ],
  "whatsapp_messages": [
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "30db27c0-35c3-4e26-882a-14fc0a5f4828",
      "node_name": "Enfileirar mensagem.",
      "key": "mensagem",
      "text": "={{ $('Info').item.json.mensagem }}"
    },
    {
      "workflow": "1. Lia_V3.1",
      "node_id": "9d3d1c90-f2ee-4380-8b8b-6badc0bb4470",
      "node_name": "HTTP Request",
      "key": "jsonBody.text",
      "text": "{{JSON.stringify($json.mensagem).slice(1,-1)}}"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "node_id": "3c800162-67f1-4f9f-b655-a8f73fe576c8",
      "node_name": "Enviar mensagem",
      "key": "jsonBody.text",
      "text": "Seu pedido foi confirmado com sucesso e j\u00e1 est\u00e1 na fila da cozinha. Em breve ele come\u00e7a a ser preparado!"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "node_id": "05c3181a-2456-4315-a975-f45f7e4418fb",
      "node_name": "Enviar mensagem1",
      "key": "jsonBody.text",
      "text": "Boa not\u00edcia, {{ $json.nome }}! \ud83c\udf54 Seu pedido j\u00e1 ficou pronto e agora est\u00e1 aguardando o entregador. Assim que sair, te aviso!"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "node_id": "2d4b3451-19c0-4bd8-b7c3-7345c9aff1f8",
      "node_name": "Enviar mensagem2",
      "key": "jsonBody.text",
      "text": "\ud83d\udeb4\u200d\u2642\ufe0f Opa, {{ $json.nome }}! Seu pedido acabou de sair para entrega. Logo logo chega a\u00ed na sua casa, pode ir preparando o apetite! \ud83d\ude0b"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "node_id": "0b699df8-cae3-4e1c-bf08-5d351b71b325",
      "node_name": "Enviar mensagem3",
      "key": "jsonBody.text",
      "text": "{{ $json.nome }}, acabamos de confirmar que seu pedido foi entregue \u2705. Esperamos que voc\u00ea aproveite muito a refei\u00e7\u00e3o! Obrigado por pedir com a gente. \ud83d\udc9b"
    },
    {
      "workflow": "5. Atualiza\u00e7\u00e3o_de_pedidos",
      "node_id": "1b45b778-b4d4-4c91-8653-fc6d2ed2ab55",
      "node_name": "Enviar mensagem4",
      "key": "jsonBody.text",
      "text": "{{ $json.nome }}. \ud83d\ude14 Seu pedido foi cancelado. Se quiser, pode falar com a gente aqui para entendermos melhor ou fazer um novo pedido a qualquer momento. Estamos \u00e0 disposi\u00e7\u00e3o!"
    }
  ],
  "endpoints": [
    "cancelar_pedido",
    "enviar-pedido",
    "marcio_lanches",
    "saipos-central",
    "v3.1"
  ],
  "tables": [
    "delivery_areas",
    "public.active_sessions",
    "public.delivery_policies_v2",
    "public.menu_catalog_agent_v1",
    "public.n8n_fila_mensagens",
    "public.orders",
    "public.saipos_menu_raw",
    "public.view_client_snapshot",
    "v_menu_catalog",
    "v_menu_search_index"
  ]
}